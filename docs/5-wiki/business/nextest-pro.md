# NexTest Pro - ä¸šåŠ¡æ–‡æ¡£

> ä¼ä¸šçº§æµ‹è¯•ç®¡ç†ä¸è‡ªåŠ¨åŒ–å¹³å°å®Œæ•´ä¸šåŠ¡æ–‡æ¡£

**æ–‡æ¡£ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-11-22  
**ç³»ç»Ÿç‰ˆæœ¬**: 0.0.0

---

## ğŸ“‹ ç›®å½•

### 1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
- 1.1 äº§å“å®šä½
- 1.2 æ ¸å¿ƒä»·å€¼
- 1.3 æŠ€æœ¯æ¶æ„
- 1.4 ç³»ç»Ÿç‰¹æ€§

### 2. [æ¶æ„è®¾è®¡](#2-æ¶æ„è®¾è®¡)
- 2.1 ç³»ç»Ÿæ¶æ„å›¾
- 2.2 æŠ€æœ¯æ ˆ
- 2.3 æ¨¡å—åˆ’åˆ†
- 2.4 æ•°æ®æµå‘

### 3. [æ•°æ®æ¨¡å‹](#3-æ•°æ®æ¨¡å‹)
- 3.1 æ ¸å¿ƒå®ä½“å…³ç³»å›¾
- 3.2 å®ä½“è¯¦ç»†è¯´æ˜
- 3.3 æ•°æ®åº“Schema
- 3.4 æšä¸¾ç±»å‹å®šä¹‰

### 4. [åŠŸèƒ½æ¨¡å—](#4-åŠŸèƒ½æ¨¡å—)
- 4.1 ä»ªè¡¨ç›˜ (Dashboard)
- 4.2 æµ‹è¯•ç”¨ä¾‹åº“ (Test Repository)
- 4.3 è‡ªåŠ¨åŒ–å®éªŒå®¤ (Automation Lab)
- 4.4 åŠ¨ä½œåº“ (Action Library)
- 4.5 æ•°æ®æ¨¡å‹ (Data Schema)
- 4.6 æ‰§è¡Œå†å² (Execution History)
- 4.7 æ–‡æ¡£ä¸­å¿ƒ (Documentation Hub)
- 4.8 ç®¡ç†åå° (Admin Portal)
- 4.9 ç³»ç»Ÿé…ç½® (System Config)

### 5. [ä¸šåŠ¡æµç¨‹](#5-ä¸šåŠ¡æµç¨‹)
- 5.1 ç”¨æˆ·ç™»å½•æµç¨‹
- 5.2 æµ‹è¯•ç”¨ä¾‹åˆ›å»ºæµç¨‹
- 5.3 å·¥ä½œæµç¼–æ’æµç¨‹
- 5.4 æµ‹è¯•æ‰§è¡Œæµç¨‹
- 5.5 æƒé™éªŒè¯æµç¨‹

### 6. [æƒé™ç³»ç»Ÿ](#6-æƒé™ç³»ç»Ÿ)
- 6.1 RBACæ¨¡å‹
- 6.2 æƒé™åˆ—è¡¨
- 6.3 è§’è‰²å®šä¹‰
- 6.4 å¤šç§Ÿæˆ·æ¶æ„

### 7. [APIæ¥å£](#7-apiæ¥å£)
- 7.1 æ¥å£è®¾è®¡åŸåˆ™
- 7.2 æ ¸å¿ƒæ¥å£åˆ—è¡¨
- 7.3 æ•°æ®äº¤äº’æ ¼å¼

### 8. [å·¥ä½œæµå¼•æ“](#8-å·¥ä½œæµå¼•æ“)
- 8.1 èŠ‚ç‚¹ç±»å‹
- 8.2 æ‰§è¡Œé€»è¾‘
- 8.3 å˜é‡ç³»ç»Ÿ
- 8.4 é”™è¯¯å¤„ç†

### 9. [AIé›†æˆ](#9-aié›†æˆ)
- 9.1 GeminiæœåŠ¡
- 9.2 AIåŠŸèƒ½åˆ—è¡¨
- 9.3 ä½¿ç”¨åœºæ™¯

### 10. [éƒ¨ç½²è¿ç»´](#10-éƒ¨ç½²è¿ç»´)
- 10.1 ç¯å¢ƒè¦æ±‚
- 10.2 éƒ¨ç½²æµç¨‹
- 10.3 é…ç½®è¯´æ˜

---


## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 äº§å“å®šä½

**NexTest Pro** æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„ä¼ä¸šçº§æµ‹è¯•ç®¡ç†ä¸è‡ªåŠ¨åŒ–å¹³å°ï¼Œèåˆäº†æµ‹è¯•ç”¨ä¾‹ç®¡ç†ã€å¯è§†åŒ–å·¥ä½œæµç¼–æ’ã€è„šæœ¬åº“ç®¡ç†å’ŒAIè¾…åŠ©åŠŸèƒ½ã€‚

**ç›®æ ‡ç”¨æˆ·**:
- QAæµ‹è¯•å·¥ç¨‹å¸ˆ
- è‡ªåŠ¨åŒ–æµ‹è¯•å¼€å‘
- æµ‹è¯•ç»ç†/é¡¹ç›®ç»ç†
- DevOpså·¥ç¨‹å¸ˆ

### 1.2 æ ¸å¿ƒä»·å€¼

```mermaid
mindmap
  root((NexTest Pro))
    æµ‹è¯•ç®¡ç†
      ç”¨ä¾‹ç»„ç»‡
      ç‰ˆæœ¬æ§åˆ¶
      æ‰§è¡Œè¿½è¸ª
    è‡ªåŠ¨åŒ–ç¼–æ’
      å¯è§†åŒ–æµç¨‹
      è„šæœ¬å¤ç”¨
      å¤šåè®®æ”¯æŒ
    å›¢é˜Ÿåä½œ
      å¤šç§Ÿæˆ·éš”ç¦»
      æƒé™ç®¡æ§
      çŸ¥è¯†æ²‰æ·€
    AIèµ‹èƒ½
      ç”¨ä¾‹ç”Ÿæˆ
      æ™ºèƒ½åˆ†æ
      é—®é¢˜è¯Šæ–­
```

### 1.3 æŠ€æœ¯æ¶æ„

```mermaid
graph TB
    subgraph "å‰ç«¯å±‚ Frontend"
        A[React 19 + TypeScript]
        B[TailwindCSS]
        C[Recharts å›¾è¡¨]
    end
    
    subgraph "çŠ¶æ€ç®¡ç† State"
        D[React Hooks]
        E[Context API]
    end
    
    subgraph "ä¸šåŠ¡é€»è¾‘å±‚ Business Logic"
        F[æµ‹è¯•ç”¨ä¾‹ç®¡ç†]
        G[å·¥ä½œæµå¼•æ“]
        H[æƒé™ç³»ç»Ÿ]
        I[ç¯å¢ƒç®¡ç†]
    end
    
    subgraph "æ•°æ®å±‚ Data"
        J[Mock Data]
        K[LocalStorage]
    end
    
    subgraph "å¤–éƒ¨æœåŠ¡ External"
        L[Gemini AI API]
        M[æœªæ¥: REST API]
    end
    
    A --> D
    D --> F
    D --> G
    D --> H
    D --> I
    F --> J
    G --> J
    H --> J
    I --> K
    F --> L
```

### 1.4 ç³»ç»Ÿç‰¹æ€§

| ç‰¹æ€§åˆ†ç±» | åŠŸèƒ½ç‚¹ | è¯´æ˜ |
|---------|--------|------|
| **æµ‹è¯•ç®¡ç†** | æ ‘å½¢ç”¨ä¾‹ç»„ç»‡ | æ”¯æŒæ–‡ä»¶å¤¹å±‚çº§ç»“æ„ |
| | æ­¥éª¤çº§ç¼–æ’ | æ¯ä¸ªæ­¥éª¤å¯ç»‘å®šè„šæœ¬ã€æ¡ä»¶ã€å¾ªç¯ |
| | å˜é‡ç³»ç»Ÿ | æ”¯æŒç¯å¢ƒå˜é‡ã€ç”¨ä¾‹å˜é‡ã€è¾“å‡ºæ˜ å°„ |
| **è‡ªåŠ¨åŒ–** | å¯è§†åŒ–å·¥ä½œæµ | ç±»ä¼¼ n8n çš„æ‹–æ‹½å¼ç¼–æ’ |
| | å¤šèŠ‚ç‚¹ç±»å‹ | HTTP/DB/Redis/Kafka/Browser/AIç­‰ |
| | å­æµç¨‹è°ƒç”¨ | å·¥ä½œæµå¯åµŒå¥—å¤ç”¨ |
| **æƒé™** | RBACæ¨¡å‹ | åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ |
| | å¤šç§Ÿæˆ· | Organization -> Project éš”ç¦» |
| | ç»†ç²’åº¦æƒé™ | èœå•çº§ + æ“ä½œçº§æƒé™ |
| **AIèƒ½åŠ›** | ç”¨ä¾‹ç”Ÿæˆ | æ ¹æ®éœ€æ±‚æè¿°è‡ªåŠ¨ç”Ÿæˆæµ‹è¯•ç”¨ä¾‹ |
| | æŠ¥å‘Šåˆ†æ | æ™ºèƒ½åˆ†ææ‰§è¡Œç»“æœå¹¶ç»™å‡ºå»ºè®® |
| | æ™ºèƒ½é—®ç­” | åŸºäºæ—¥å¿—çš„é—®é¢˜è¯Šæ–­ |

---


## 2. æ¶æ„è®¾è®¡

### 2.1 ç³»ç»Ÿæ¶æ„å›¾

```mermaid
C4Context
    title ç³»ç»Ÿä¸Šä¸‹æ–‡å›¾ - NexTest Pro

    Person(user, "æµ‹è¯•å·¥ç¨‹å¸ˆ", "ä½¿ç”¨å¹³å°ç®¡ç†å’Œæ‰§è¡Œæµ‹è¯•")
    Person(admin, "ç³»ç»Ÿç®¡ç†å‘˜", "ç®¡ç†ç”¨æˆ·å’Œæƒé™")
    
    System(nextest, "NexTest Pro", "æµ‹è¯•ç®¡ç†ä¸è‡ªåŠ¨åŒ–å¹³å°")
    
    System_Ext(gemini, "Gemini AI", "AIè¾…åŠ©åŠŸèƒ½")
    System_Ext(target, "è¢«æµ‹ç³»ç»Ÿ", "HTTP/DB/æ¶ˆæ¯é˜Ÿåˆ—ç­‰")
    
    Rel(user, nextest, "ä½¿ç”¨", "HTTPS")
    Rel(admin, nextest, "ç®¡ç†", "HTTPS")
    Rel(nextest, gemini, "è°ƒç”¨", "API")
    Rel(nextest, target, "æµ‹è¯•", "å¤šåè®®")
```

### 2.2 æŠ€æœ¯æ ˆ

```mermaid
graph LR
    subgraph "å‰ç«¯æŠ€æœ¯æ ˆ"
        A[React 19.2.0]
        B[TypeScript 5.8.2]
        C[Vite 6.2.0]
        D[TailwindCSS CDN]
        E[Lucide Icons]
        F[Recharts 3.4.1]
    end
    
    subgraph "å¼€å‘å·¥å…·"
        G[pnpm]
        H[ESM Import Maps]
    end
    
    subgraph "å¤–éƒ¨ä¾èµ–"
        I[google/genai 1.30.0]
        J[js-yaml 4.1.0]
    end
```

**æŠ€æœ¯é€‰å‹è¯´æ˜**:

| æŠ€æœ¯ | ç‰ˆæœ¬ | é€‰å‹ç†ç”± |
|------|------|----------|
| React | 19.2.0 | æœ€æ–°ç‰ˆæœ¬ï¼Œæ€§èƒ½ä¼˜åŒ–ï¼Œå¹¶å‘ç‰¹æ€§ |
| TypeScript | 5.8.2 | ç±»å‹å®‰å…¨ï¼Œæå‡ä»£ç è´¨é‡ |
| Vite | 6.2.0 | å¿«é€Ÿå¼€å‘æœåŠ¡å™¨ï¼ŒHMR |
| TailwindCSS | CDN | å¿«é€ŸåŸå‹å¼€å‘ï¼Œæ— éœ€æ„å»ºé…ç½® |
| Recharts | 3.4.1 | ReactåŸç”Ÿå›¾è¡¨åº“ï¼Œæ˜“äºé›†æˆ |
| Gemini AI | 1.30.0 | Google AIæœåŠ¡ï¼Œæ”¯æŒç»“æ„åŒ–è¾“å‡º |

### 2.3 æ¨¡å—åˆ’åˆ†

```mermaid
graph TD
    A[NexTest Pro] --> B[æ ¸å¿ƒæ¨¡å—]
    A --> C[ä¸šåŠ¡æ¨¡å—]
    A --> D[æ”¯æ’‘æ¨¡å—]
    
    B --> B1[çŠ¶æ€ç®¡ç† useAppState]
    B --> B2[æƒé™ç³»ç»Ÿ usePermissions]
    B --> B3[é…ç½®ç®¡ç† ConfigContext]
    
    C --> C1[æµ‹è¯•ç”¨ä¾‹ç®¡ç†]
    C --> C2[å·¥ä½œæµå¼•æ“]
    C --> C3[è„šæœ¬åº“ç®¡ç†]
    C --> C4[æ‰§è¡Œå†å²]
    C --> C5[æ•°æ®æ¨¡å‹ç®¡ç†]
    
    D --> D1[AIæœåŠ¡ geminiService]
    D --> D2[å¤šè¯­è¨€ translations]
    D --> D3[ä¸»é¢˜ç³»ç»Ÿ]
    D --> D4[ç¯å¢ƒç®¡ç†]
```

### 2.4 æ•°æ®æµå‘

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant UI as UIç»„ä»¶
    participant H as Hookså±‚
    participant S as æœåŠ¡å±‚
    participant D as æ•°æ®å±‚
    
    U->>UI: æ“ä½œç•Œé¢
    UI->>H: è°ƒç”¨Hookæ–¹æ³•
    H->>H: æƒé™éªŒè¯
    alt æœ‰æƒé™
        H->>D: è¯»å–/æ›´æ–°æ•°æ®
        D-->>H: è¿”å›æ•°æ®
        H->>S: è°ƒç”¨å¤–éƒ¨æœåŠ¡(å¯é€‰)
        S-->>H: è¿”å›ç»“æœ
        H-->>UI: æ›´æ–°çŠ¶æ€
        UI-->>U: æ˜¾ç¤ºç»“æœ
    else æ— æƒé™
        H-->>UI: è¿”å›æ‹’ç»
        UI-->>U: æ˜¾ç¤º"Access Denied"
    end
```

**æ•°æ®æµè¯´æ˜**:

1. **å•å‘æ•°æ®æµ**: éµå¾ª React å•å‘æ•°æ®æµåŸåˆ™
2. **çŠ¶æ€æå‡**: å…¨å±€çŠ¶æ€é€šè¿‡ `useAppState` ç®¡ç†
3. **æƒé™æ‹¦æˆª**: æ‰€æœ‰æ“ä½œå‰è¿›è¡Œæƒé™éªŒè¯
4. **å¤šç§Ÿæˆ·è¿‡æ»¤**: æ•°æ®æŒ‰ `projectId` è‡ªåŠ¨è¿‡æ»¤

---


## 3. æ•°æ®æ¨¡å‹

### 3.1 æ ¸å¿ƒå®ä½“å…³ç³»å›¾

```mermaid
erDiagram
    Organization ||--o{ Project : contains
    Organization ||--o{ User : belongs_to
    Project ||--o{ TestFolder : contains
    Project ||--o{ TestCase : contains
    Project ||--o{ Script : contains
    Project ||--o{ Workflow : contains
    Project ||--o{ Environment : has
    Project ||--o{ TestRun : generates
    
    User ||--|| Role : has
    Role ||--o{ Permission : grants
    
    TestFolder ||--o{ TestFolder : parent_child
    TestFolder ||--o{ TestCase : contains
    
    TestCase ||--o{ TestStep : contains
    TestCase ||--o{ TestRun : executes
    TestCase ||--o| Workflow : linked_to
    
    TestStep ||--o| Script : binds
    TestStep ||--o| Workflow : calls
    
    Workflow ||--o{ WorkflowNode : contains
    WorkflowNode ||--o| Script : references
    WorkflowNode ||--o| TestCase : references
    WorkflowNode ||--o| Workflow : calls_sub
    
    Organization {
        string id PK
        string name
        string parentId FK
        enum type
    }
    
    Project {
        string id PK
        string orgId FK
        string name
        string key
        string description
    }
    
    User {
        string id PK
        string name
        string email
        string roleId FK
        string orgId FK
        string avatar
        enum status
    }
    
    Role {
        string id PK
        string name
        array permissionCodes
        string description
    }
    
    TestCase {
        string id PK
        string projectId FK
        string title
        string description
        enum priority
        enum status
        array steps
        object variables
        array tags
        string folderId FK
        string linkedWorkflowId FK
    }
    
    TestStep {
        string id PK
        string summary
        string instruction
        string expectedResult
        string condition
        string loopOver
        string linkedScriptId FK
        object parameterValues
        object outputMapping
    }
    
    Script {
        string id PK
        string projectId FK
        string name
        enum type
        string content
        array parameters
        array outputs
        boolean isTemplate
        array tags
    }
    
    Workflow {
        string id PK
        string projectId FK
        string name
        string description
        array nodes
        array inputSchema
        array outputSchema
        enum lastRunStatus
    }
    
    Environment {
        string id PK
        string projectId FK
        string name
        array variables
        string color
    }
    
    TestRun {
        string id PK
        string projectId FK
        string name
        string caseId FK
        string executedAt
        enum status
        string notes
        array logs
        string environmentName
    }
```

### 3.2 å®ä½“è¯¦ç»†è¯´æ˜

#### 3.2.1 å¤šç§Ÿæˆ·å®ä½“

**Organization (ç»„ç»‡)**
```typescript
interface Organization {
  id: string;              // å”¯ä¸€æ ‡è¯†
  name: string;            // ç»„ç»‡åç§°ï¼Œå¦‚ "Acme Corp Global"
  parentId?: string;       // çˆ¶ç»„ç»‡IDï¼Œæ”¯æŒå±‚çº§ç»“æ„
  type: 'department' | 'team';  // ç»„ç»‡ç±»å‹
}
```

**Project (é¡¹ç›®)**
```typescript
interface Project {
  id: string;              // å”¯ä¸€æ ‡è¯†
  orgId: string;           // æ‰€å±ç»„ç»‡
  name: string;            // é¡¹ç›®åç§°ï¼Œå¦‚ "E-Commerce Core"
  key: string;             // é¡¹ç›®ç®€ç§°ï¼Œå¦‚ "ECC"
  description?: string;    // é¡¹ç›®æè¿°
}
```

**æ•°æ®éš”ç¦»è§„åˆ™**:
```mermaid
graph LR
    A[ç”¨æˆ·ç™»å½•] --> B{é€‰æ‹©ç»„ç»‡}
    B --> C{é€‰æ‹©é¡¹ç›®}
    C --> D[æ‰€æœ‰æ•°æ®æŒ‰projectIdè¿‡æ»¤]
    D --> E[TestCase]
    D --> F[Script]
    D --> G[Workflow]
    D --> H[Environment]
    D --> I[TestRun]
```

#### 3.2.2 æƒé™å®ä½“

**User (ç”¨æˆ·)**
```typescript
interface User {
  id: string;
  name: string;
  email: string;
  roleId: string;          // å…³è”è§’è‰²
  orgId: string;           // æ‰€å±ç»„ç»‡
  avatar?: string;         // å¤´åƒURL
  status: 'active' | 'inactive';
}
```

**Role (è§’è‰²)**
```typescript
interface Role {
  id: string;
  name: string;            // å¦‚ "Administrator", "Editor", "Viewer"
  permissionCodes: string[]; // æƒé™ä»£ç åˆ—è¡¨
  description?: string;
}
```

**Permission (æƒé™)**
```typescript
interface Permission {
  code: string;            // å¦‚ "VIEW_DASHBOARD", "CREATE_CASE"
  name: string;            // æ˜¾ç¤ºåç§°
  category: 'Menu' | 'Action' | 'System';
  description: string;
}
```

#### 3.2.3 æµ‹è¯•å®ä½“

**TestCase (æµ‹è¯•ç”¨ä¾‹)**
```typescript
interface TestCase {
  id: string;
  projectId: string;       // å¤šç§Ÿæˆ·éš”ç¦»
  title: string;
  description: string;
  priority: Priority;      // LOW | MEDIUM | HIGH | CRITICAL
  status: Status;          // DRAFT | ACTIVE | DEPRECATED
  steps: TestStep[];       // æµ‹è¯•æ­¥éª¤
  variables?: Record<string, string>;  // ç”¨ä¾‹çº§å˜é‡
  preconditions?: string[];            // å‰ç½®æ¡ä»¶
  testData?: TestData[];               // æµ‹è¯•æ•°æ®
  tags: string[];
  folderId: string;
  lastUpdated: string;
  automationType?: 'MANUAL' | 'WORKFLOW';
  linkedWorkflowId?: string;  // å…³è”çš„è‡ªåŠ¨åŒ–å·¥ä½œæµ
}
```

**TestStep (æµ‹è¯•æ­¥éª¤)**
```typescript
interface TestStep {
  id: string;
  summary?: string;        // æ­¥éª¤æ ‡é¢˜
  instruction: string;     // è¯¦ç»†è¯´æ˜ï¼Œæ”¯æŒå˜é‡ {{var}}
  expectedResult: string;  // é¢„æœŸç»“æœ
  
  // æ§åˆ¶æµ
  condition?: string;      // æ¡ä»¶æ‰§è¡Œï¼Œå¦‚ "{{user}} != null"
  loopOver?: string;       // å¾ªç¯å˜é‡ï¼Œå¦‚ "{{userList}}"
  loopVar?: string;        // è¿­ä»£å™¨å˜é‡å
  
  // è‡ªåŠ¨åŒ–ç»‘å®š
  linkedScriptId?: string;           // ç»‘å®šçš„è„šæœ¬ID
  parameterValues?: Record<string, string>;  // å‚æ•°æ˜ å°„
  outputMapping?: Record<string, string>;    // è¾“å‡ºæ˜ å°„
  linkedWorkflowId?: string;         // è°ƒç”¨å­å·¥ä½œæµ
}
```

#### 3.2.4 è‡ªåŠ¨åŒ–å®ä½“

**Script (è„šæœ¬)**
```typescript
interface Script {
  id: string;
  projectId: string;
  name: string;
  description?: string;
  type: ScriptType;        // PYTHON | JAVASCRIPT | SHELL | TEMPLATE
  content: string;         // è„šæœ¬ä»£ç 
  parameters: ScriptParameter[];  // è¾“å…¥å‚æ•°å®šä¹‰
  outputs?: ScriptParameter[];    // è¾“å‡ºå‚æ•°å®šä¹‰
  testExamples?: TestExample[];   // æµ‹è¯•ç¤ºä¾‹
  isTemplate: boolean;     // æ˜¯å¦ä¸ºæ¨¡æ¿
  tags: string[];
  lastModified: string;
}
```

**Workflow (å·¥ä½œæµ)**
```typescript
interface Workflow {
  id: string;
  projectId: string;
  name: string;
  description: string;
  nodes: WorkflowNode[];   // èŠ‚ç‚¹åˆ—è¡¨
  inputSchema?: ScriptParameter[];   // å…¨å±€è¾“å…¥
  outputSchema?: ScriptParameter[];  // å…¨å±€è¾“å‡º
  lastRunStatus?: ExecutionStatus;
  lastRunAt?: string;
}
```

**WorkflowNode (å·¥ä½œæµèŠ‚ç‚¹)**
```typescript
interface WorkflowNode {
  id: string;
  type: NodeType;          // èŠ‚ç‚¹ç±»å‹ï¼Œè§ä¸‹æ–‡
  name: string;
  referenceId?: string;    // å¼•ç”¨çš„èµ„æºID
  stepId?: string;         // å¼•ç”¨çš„æ­¥éª¤ID
  config?: NodeConfig;     // èŠ‚ç‚¹é…ç½®
  children?: WorkflowNode[];      // å­èŠ‚ç‚¹ï¼ˆå¾ªç¯/æ¡ä»¶ï¼‰
  elseChildren?: WorkflowNode[];  // Elseåˆ†æ”¯
}
```

### 3.3 æ•°æ®åº“Schema

**users è¡¨**
```sql
CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR NOT NULL,
    email VARCHAR NOT NULL,
    created_at TIMESTAMP NOT NULL
);
```

**orders è¡¨**
```sql
CREATE TABLE orders (
    id INT PRIMARY KEY,
    user_id INT,
    total DECIMAL,
    status VARCHAR,
    created_at TIMESTAMP
);
```

### 3.4 æšä¸¾ç±»å‹å®šä¹‰

```mermaid
classDiagram
    class Priority {
        <<enumeration>>
        LOW
        MEDIUM
        HIGH
        CRITICAL
    }
    
    class Status {
        <<enumeration>>
        DRAFT
        ACTIVE
        DEPRECATED
    }
    
    class ExecutionStatus {
        <<enumeration>>
        PENDING
        RUNNING
        PASSED
        FAILED
        BLOCKED
        SKIPPED
    }
    
    class ScriptType {
        <<enumeration>>
        PYTHON
        JAVASCRIPT
        SHELL
        TEMPLATE
    }
    
    class NodeType {
        <<enumeration>>
        TEST_CASE
        STEP
        SCRIPT
        LOOP
        CONDITION
        HTTP_REQUEST
        DB_QUERY
        REDIS_CMD
        KAFKA_PUB
        ES_QUERY
        SHELL_CMD
        BROWSER_ACTION
        RPC_CALL
        LLM_PROMPT
        MCP_TOOL
        CALL_WORKFLOW
    }
```

---


## 4. åŠŸèƒ½æ¨¡å—

### 4.1 ä»ªè¡¨ç›˜ (Dashboard)

**åŠŸèƒ½æ¦‚è¿°**: æ‰§è¡Œæ¦‚è§ˆä¸å®æ—¶æŒ‡æ ‡å±•ç¤º

**é¡µé¢å¸ƒå±€**:
```mermaid
graph TD
    A[ä»ªè¡¨ç›˜] --> B[å…³é”®æŒ‡æ ‡å¡ç‰‡]
    A --> C[AIæ™ºèƒ½æ€»ç»“]
    A --> D[å½“å‰çŠ¶æ€é¥¼å›¾]
    A --> E[è¶‹åŠ¿åˆ†ææŸ±çŠ¶å›¾]
    
    B --> B1[é€šè¿‡ç‡ 67%]
    B --> B2[å¤±è´¥æ€»æ•° 1]
    B --> B3[å·²æ‰§è¡Œ 3]
    B --> B4[å¾…å®š/è·³è¿‡ 0]
```

**æ•°æ®æ¥æº**:
- ä» `TestRun[]` æ•°ç»„ç»Ÿè®¡å½“å‰é¡¹ç›®çš„æ‰§è¡Œè®°å½•
- æŒ‰ `projectId` è¿‡æ»¤ï¼Œåªæ˜¾ç¤ºå½“å‰é¡¹ç›®æ•°æ®
- å®æ—¶è®¡ç®—é€šè¿‡ç‡ = PASSED / (PASSED + FAILED)

**äº¤äº’åŠŸèƒ½**:
1. **å¯¼å‡ºæŠ¥å‘Š**: ç‚¹å‡»å³ä¸Šè§’æŒ‰é’®å¯¼å‡ºPDF/ExcelæŠ¥å‘Š
2. **AIåˆ†æ**: è°ƒç”¨ Gemini API åˆ†ææ‰§è¡Œæ‘˜è¦ï¼Œç»™å‡ºé£é™©è¯„ä¼°

**æƒé™è¦æ±‚**: `VIEW_DASHBOARD`

---


### 4.2 æµ‹è¯•ç”¨ä¾‹åº“ (Test Repository)

**åŠŸèƒ½æ¦‚è¿°**: æ ‘å½¢ç»“æ„çš„æµ‹è¯•ç”¨ä¾‹ç®¡ç†

**é¡µé¢å¸ƒå±€**:
```mermaid
graph LR
    A[æµ‹è¯•ç”¨ä¾‹åº“] --> B[å·¦ä¾§: æ–‡ä»¶å¤¹æ ‘]
    A --> C[ä¸­é—´: ç”¨ä¾‹åˆ—è¡¨]
    A --> D[å³ä¾§: ç”¨ä¾‹è¯¦æƒ…]
    
    B --> B1[æ‰€æœ‰é¡¹ç›®]
    B --> B2[Checkout Module]
    B --> B3[Payment Gateway]
    B --> B4[Authentication]
    
    C --> C1[TC-102 High]
    C --> C2[ç­›é€‰æ¡†]
    C --> C3[AIç”ŸæˆæŒ‰é’®]
    
    D --> D1[æ ‡é¢˜/çŠ¶æ€]
    D --> D2[æµ‹è¯•æ­¥éª¤]
    D --> D3[ç¼–è¾‘/è¿è¡ŒæŒ‰é’®]
```

**æ ¸å¿ƒåŠŸèƒ½**:

1. **æ–‡ä»¶å¤¹ç®¡ç†**
   - æ”¯æŒä¸‰å±‚ç»“æ„: Project -> Module -> Folder
   - æ‹–æ‹½æ’åºï¼ˆæœªå®ç°ï¼‰
   - æ–°å»ºæ–‡ä»¶å¤¹

2. **ç”¨ä¾‹ç®¡ç†**
   - åˆ›å»ºç”¨ä¾‹ï¼ˆæ‰‹åŠ¨/AIç”Ÿæˆï¼‰
   - ç¼–è¾‘ç”¨ä¾‹ï¼ˆæ ‡é¢˜ã€æè¿°ã€ä¼˜å…ˆçº§ã€æ­¥éª¤ï¼‰
   - åˆ é™¤ç”¨ä¾‹
   - ç­›é€‰æœç´¢

3. **æ­¥éª¤ç¼–æ’**
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as æ­¥éª¤
    participant Sc as è„šæœ¬
    participant V as å˜é‡ç³»ç»Ÿ
    
    U->>S: å®šä¹‰æ­¥éª¤
    S->>Sc: ç»‘å®šè„šæœ¬(å¯é€‰)
    Sc->>V: è¾“å‡ºæ˜ å°„
    V->>S: ä¸‹ä¸€æ­¥éª¤ä½¿ç”¨å˜é‡
    
    Note over S: æ”¯æŒæ¡ä»¶æ‰§è¡Œ
    Note over S: æ”¯æŒå¾ªç¯éå†
```

4. **å˜é‡ç³»ç»Ÿ**
   - ç”¨ä¾‹çº§å˜é‡: `variables: {testUser: 'admin_01'}`
   - ç¯å¢ƒå˜é‡: ä» `activeEnv` è¯»å–
   - æ­¥éª¤è¾“å‡º: `outputMapping: {testUserId: 'currentUser'}`
   - ä½¿ç”¨è¯­æ³•: `{{variableName}}`

**æƒé™è¦æ±‚**: 
- æŸ¥çœ‹: `VIEW_CASES`
- åˆ›å»º: `CREATE_CASE`
- ç¼–è¾‘: `EDIT_CASE`
- åˆ é™¤: `DELETE_CASE`

---


### 4.3 è‡ªåŠ¨åŒ–å®éªŒå®¤ (Automation Lab)

**åŠŸèƒ½æ¦‚è¿°**: å¯è§†åŒ–å·¥ä½œæµç¼–æ’å™¨

**é¡µé¢å¸ƒå±€**:
```mermaid
graph TB
    A[è‡ªåŠ¨åŒ–å®éªŒå®¤] --> B[æµæ°´çº¿æ ‡ç­¾]
    A --> C[åŠ¨ä½œåº“æ ‡ç­¾]
    
    B --> B1[å·¥ä½œæµåˆ—è¡¨]
    B --> B2[ç”»å¸ƒåŒºåŸŸ]
    B --> B3[èŠ‚ç‚¹é¢æ¿]
    
    B2 --> B2a[å¼€å§‹èŠ‚ç‚¹]
    B2 --> B2b[ä¸šåŠ¡èŠ‚ç‚¹]
    B2 --> B2c[ç»“æŸèŠ‚ç‚¹]
    
    B3 --> B3a[LOGIC & FLOW]
    B3 --> B3b[INTEGRATION]
    B3 --> B3c[DATA & STORE]
    B3 --> B3d[INFRASTRUCTURE]
    B3 --> B3e[AI & AGENTS]
```

**å·¥ä½œæµèŠ‚ç‚¹ç±»å‹**:

```mermaid
mindmap
  root((èŠ‚ç‚¹ç±»å‹))
    é€»è¾‘æ§åˆ¶
      If/Else æ¡ä»¶
      Loop å¾ªç¯
      Sub Flow å­æµç¨‹
    é›†æˆ
      HTTP Request
      RPC Call
      MCP Tool
    æ•°æ®å­˜å‚¨
      SQL Query
      Redis Command
      Elasticsearch
    åŸºç¡€è®¾æ–½
      Kafka Publish
      Shell Command
    AIä»£ç†
      Gemini Prompt
      Browser Action
```

**å·¥ä½œæµç¤ºä¾‹**:
```yaml
# Nightly Critical Path å·¥ä½œæµ
name: Nightly Critical Path
nodes:
  - id: n1
    type: SCRIPT
    name: DataSetup.py
    
  - id: n2
    type: CONDITION
    name: Check Environment
    config:
      condition: "env.isReady == true"
    children:
      - type: STEP
        name: Navigate to login
      - type: STEP
        name: Click Login
    elseChildren:
      - type: SCRIPT
        name: SendAlert.py
        
  - id: n3
    type: LOOP
    name: Stress Test Cart
    config:
      loopCount: 5
    children:
      - type: TEST_CASE
        referenceId: TC-102
        
  - id: n4
    type: HTTP_REQUEST
    name: Sync to Jira
    config:
      method: POST
      url: "https://jira.api/v2/sync"
```

**ç¼–è¾‘åŠŸèƒ½**:
1. æ‹–æ‹½æ·»åŠ èŠ‚ç‚¹
2. è¿çº¿å®šä¹‰æ‰§è¡Œé¡ºåº
3. é…ç½®èŠ‚ç‚¹å‚æ•°
4. æ°´å¹³/å‚ç›´å¸ƒå±€åˆ‡æ¢
5. å¯è§†åŒ–/YAMLè§†å›¾åˆ‡æ¢

**æ‰§è¡Œé€»è¾‘**:
```mermaid
stateDiagram-v2
    [*] --> å¼€å§‹èŠ‚ç‚¹
    å¼€å§‹èŠ‚ç‚¹ --> æ‰§è¡ŒèŠ‚ç‚¹1
    æ‰§è¡ŒèŠ‚ç‚¹1 --> æ¡ä»¶åˆ¤æ–­
    
    æ¡ä»¶åˆ¤æ–­ --> Trueåˆ†æ”¯: condition=true
    æ¡ä»¶åˆ¤æ–­ --> Falseåˆ†æ”¯: condition=false
    
    Trueåˆ†æ”¯ --> å¾ªç¯èŠ‚ç‚¹
    Falseåˆ†æ”¯ --> å‘Šè­¦èŠ‚ç‚¹
    
    å¾ªç¯èŠ‚ç‚¹ --> å¾ªç¯ä½“: è¿­ä»£Næ¬¡
    å¾ªç¯ä½“ --> å¾ªç¯èŠ‚ç‚¹: ç»§ç»­
    å¾ªç¯èŠ‚ç‚¹ --> HTTPèŠ‚ç‚¹: å®Œæˆ
    
    å‘Šè­¦èŠ‚ç‚¹ --> ç»“æŸèŠ‚ç‚¹
    HTTPèŠ‚ç‚¹ --> ç»“æŸèŠ‚ç‚¹
    ç»“æŸèŠ‚ç‚¹ --> [*]
```

**æƒé™è¦æ±‚**: `VIEW_AUTOMATION`, `MANAGE_SCRIPTS`

---


### 4.4 åŠ¨ä½œåº“ (Action Library)

**åŠŸèƒ½æ¦‚è¿°**: è„šæœ¬å’Œæ¨¡æ¿ç®¡ç†ä¸­å¿ƒ

**ä¸‰å¤§åˆ†ç±»**:

```mermaid
graph LR
    A[åŠ¨ä½œåº“] --> B[å†…ç½®æ¨¡å—]
    A --> C[è‡ªå®šä¹‰åŠ¨ä½œ]
    A --> D[æ¨¡æ¿]
    
    B --> B1[HTTP Request]
    B --> B2[Database Query]
    B --> B3[Redis Command]
    B --> B4[Kafka Publish]
    B --> B5[Browser Action]
    
    C --> C1[Setup Test Database]
    C --> C2[Clean Temp Files]
    
    D --> D1[REST API Validator]
    D --> D2[Data ETL Transformer]
    D --> D3[Log Pattern Analyzer]
```

**å†…ç½®æ¨¡å—åˆ—è¡¨**:

| ç±»åˆ« | æ¨¡å—å | è¯´æ˜ |
|------|--------|------|
| NETWORK | HTTP Request | å‘é€REST APIè¯·æ±‚ |
| DATA | Database Query | æ‰§è¡ŒSQLæŸ¥è¯¢ |
| DATA | Redis Command | Redisç¼“å­˜æ“ä½œ |
| MESSAGING | Kafka Publish | å‘å¸ƒKafkaæ¶ˆæ¯ |
| DATA | Elasticsearch | ESæŸ¥è¯¢ |
| SYSTEM | Shell Command | æ‰§è¡ŒShellå‘½ä»¤ |
| UI | Browser Action | æµè§ˆå™¨è‡ªåŠ¨åŒ– |

**è‡ªå®šä¹‰åŠ¨ä½œç»“æ„**:
```typescript
{
  id: "sc-1",
  name: "Setup Test Database",
  type: "Python",
  parameters: [
    {
      name: "target_env",
      type: "string",
      description: "Environment (dev/staging)",
      defaultValue: "dev"
    }
  ],
  outputs: [
    {
      name: "userId",
      type: "string",
      description: "ID of the created test user"
    }
  ],
  testExamples: [
    {
      id: "te-1",
      name: "Dev Environment",
      inputValues: { target_env: "dev" }
    }
  ]
}
```

**è„šæœ¬æµ‹è¯•åŠŸèƒ½**:
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant UI as åŠ¨ä½œåº“UI
    participant E as æ‰§è¡Œå¼•æ“
    participant S as è„šæœ¬
    
    U->>UI: ç‚¹å‡»"Details & Test"
    UI->>UI: æ˜¾ç¤ºå‚æ•°è¡¨å•
    U->>UI: å¡«å†™æµ‹è¯•å‚æ•°
    UI->>E: æäº¤æ‰§è¡Œè¯·æ±‚
    E->>S: è¿è¡Œè„šæœ¬
    S-->>E: è¿”å›è¾“å‡º
    E-->>UI: æ˜¾ç¤ºç»“æœ
    UI-->>U: å±•ç¤ºè¾“å‡ºå’Œæ—¥å¿—
```

**æ¨¡æ¿ä½¿ç”¨æµç¨‹**:
1. æµè§ˆæ¨¡æ¿åº“
2. é€‰æ‹©åˆé€‚çš„æ¨¡æ¿
3. å…‹éš†ä¸ºè‡ªå®šä¹‰åŠ¨ä½œ
4. ä¿®æ”¹å‚æ•°å’Œä»£ç 
5. ä¿å­˜å¹¶æµ‹è¯•
6. åœ¨å·¥ä½œæµä¸­å¼•ç”¨

**æƒé™è¦æ±‚**: `VIEW_LIBRARY`, `MANAGE_SCRIPTS`

---


### 4.5 æ•°æ®æ¨¡å‹ (Data Schema)

**åŠŸèƒ½æ¦‚è¿°**: æ•°æ®åº“è¡¨ç»“æ„ç®¡ç†

**é¡µé¢å¸ƒå±€**:
```mermaid
graph LR
    A[æ•°æ®æ¨¡å‹] --> B[å·¦ä¾§: è¡¨åˆ—è¡¨]
    A --> C[å³ä¾§: è¡¨è¯¦æƒ…]
    
    B --> B1[users]
    B --> B2[orders]
    
    C --> C1[è®¾è®¡æ ‡ç­¾]
    C --> C2[æ•°æ®æ ‡ç­¾]
    
    C1 --> C1a[åˆ—å®šä¹‰]
    C1 --> C1b[ä¸»é”®æ ‡è¯†]
    C1 --> C1c[æ•°æ®ç±»å‹]
    
    C2 --> C2a[è¡¨æ•°æ®é¢„è§ˆ]
    C2 --> C2b[CRUDæ“ä½œ]
```

**è¡¨ç»“æ„ç¤ºä¾‹**:
```sql
-- users è¡¨
CREATE TABLE users (
    id INT PRIMARY KEY,
    username VARCHAR NOT NULL,
    email VARCHAR NOT NULL,
    created_at TIMESTAMP NOT NULL
);

-- orders è¡¨  
CREATE TABLE orders (
    id INT PRIMARY KEY,
    user_id INT REFERENCES users(id),
    total DECIMAL,
    status VARCHAR,
    created_at TIMESTAMP
);
```

**åŠŸèƒ½ç‰¹æ€§**:
- å¯è§†åŒ–è¡¨ç»“æ„è®¾è®¡
- åˆ—çš„å¢åˆ æ”¹
- æ•°æ®ç±»å‹é€‰æ‹©
- ä¸»é”®/å¤–é”®å®šä¹‰
- è¡¨æ•°æ®é¢„è§ˆå’Œç¼–è¾‘

**æƒé™è¦æ±‚**: `VIEW_DATABASE`

---

### 4.6 æ‰§è¡Œå†å² (Execution History)

**åŠŸèƒ½æ¦‚è¿°**: æµ‹è¯•è¿è¡Œè®°å½•æŸ¥è¯¢

**é¡µé¢å¸ƒå±€**:
```mermaid
graph TD
    A[æ‰§è¡Œå†å²] --> B[ç­›é€‰å™¨]
    A --> C[è®°å½•åˆ—è¡¨]
    A --> D[è¯¦æƒ…é¢æ¿]
    
    B --> B1[ALL]
    B --> B2[Passed]
    B --> B3[Failed]
    B --> B4[Skipped]
    
    C --> C1[Run: TC-102 Failed]
    C --> C2[Run: TC-101 Passed]
    C --> C3[Run: TC-101 Passed]
    
    D --> D1[æ‰§è¡Œæ—¶é—´]
    D --> D2[çŠ¶æ€]
    D --> D3[æ—¥å¿—]
    D --> D4[å¤‡æ³¨]
```

**è®°å½•ç»“æ„**:
```typescript
interface TestRun {
  id: "r1",
  projectId: "proj-1",
  name: "Run: TC-101",
  caseId: "TC-101",
  executedAt: "2025-11-22T02:19:57Z",
  status: ExecutionStatus.PASSED,
  logs: [
    "> Step 1 Passed",
    "> Step 2 Passed"
  ],
  environmentName: "Staging",
  notes: "Calculation off by $1"
}
```

**çŠ¶æ€ç»Ÿè®¡**:
```mermaid
pie title æ‰§è¡ŒçŠ¶æ€åˆ†å¸ƒ
    "Passed" : 67
    "Failed" : 33
```

**æƒé™è¦æ±‚**: `VIEW_HISTORY`

---

### 4.7 æ–‡æ¡£ä¸­å¿ƒ (Documentation Hub)

**åŠŸèƒ½æ¦‚è¿°**: é¡¹ç›®çŸ¥è¯†åº“è‡ªåŠ¨ç”Ÿæˆ

**å››å¤§æ¿å—**:
```mermaid
graph TB
    A[æ–‡æ¡£ä¸­å¿ƒ] --> B[æ•°æ®æ¨¡å‹]
    A --> C[ä¸šåŠ¡é€»è¾‘]
    A --> D[APIæ¥å£]
    A --> E[å·¥ä½œæµ]
    
    B --> B1[ç³»ç»Ÿå®ä½“åˆ—è¡¨]
    B --> B2[ERå›¾]
    
    C --> C1[ä¸šåŠ¡è§„åˆ™]
    C --> C2[æµç¨‹å›¾]
    
    D --> D1[æ¥å£åˆ—è¡¨]
    D --> D2[è¯·æ±‚/å“åº”ç¤ºä¾‹]
    
    E --> E1[å·¥ä½œæµåˆ—è¡¨]
    E --> E2[èŠ‚ç‚¹è¯´æ˜]
```

**è‡ªåŠ¨ç”Ÿæˆå†…å®¹**:
1. **æ•°æ®æ¨¡å‹**: ä» `types.ts` æå–å®ä½“å®šä¹‰
2. **ä¸šåŠ¡é€»è¾‘**: ä»æµ‹è¯•ç”¨ä¾‹æå–ä¸šåŠ¡è§„åˆ™
3. **APIæ¥å£**: ä»å·¥ä½œæµHTTPèŠ‚ç‚¹æå–
4. **å·¥ä½œæµ**: å±•ç¤ºæ‰€æœ‰å·¥ä½œæµçš„å¯è§†åŒ–å›¾

**æƒé™è¦æ±‚**: `VIEW_DOCS`

---

### 4.8 ç®¡ç†åå° (Admin Portal)

**åŠŸèƒ½æ¦‚è¿°**: ç”¨æˆ·ã€è§’è‰²ã€ç»„ç»‡ã€é¡¹ç›®ç®¡ç†

**å››å¤§æ ‡ç­¾**:
```mermaid
graph LR
    A[ç®¡ç†åå°] --> B[ç”¨æˆ·ç®¡ç†]
    A --> C[è§’è‰²ä¸æƒé™]
    A --> D[ç»„ç»‡æ¶æ„]
    A --> E[Projects]
    
    B --> B1[ç”¨æˆ·åˆ—è¡¨]
    B --> B2[æ·»åŠ ç”¨æˆ·]
    B --> B3[ç¼–è¾‘/åœç”¨]
    
    C --> C1[è§’è‰²åˆ—è¡¨]
    C --> C2[æƒé™çŸ©é˜µ]
    
    D --> D1[ç»„ç»‡æ ‘]
    D --> D2[éƒ¨é—¨ç®¡ç†]
    
    E --> E1[é¡¹ç›®åˆ—è¡¨]
    E --> E2[é¡¹ç›®é…ç½®]
```

**ç”¨æˆ·ç®¡ç†**:
```typescript
// ç”¨æˆ·åˆ—è¡¨ç¤ºä¾‹
[
  {
    name: "Alice Admin",
    email: "alice@company.com",
    role: "Administrator",
    org: "Acme Corp Global",
    status: "æ´»è·ƒ"
  },
  {
    name: "Bob Tester",
    email: "bob@company.com",
    role: "Editor",
    org: "Acme Corp Global",
    status: "æ´»è·ƒ"
  }
]
```

**è§’è‰²æƒé™çŸ©é˜µ**:
| è§’è‰² | æŸ¥çœ‹ä»ªè¡¨ç›˜ | åˆ›å»ºç”¨ä¾‹ | ç®¡ç†ç”¨æˆ· | ç³»ç»Ÿé…ç½® |
|------|-----------|---------|---------|---------|
| Administrator | âœ… | âœ… | âœ… | âœ… |
| Editor | âœ… | âœ… | âŒ | âŒ |
| Viewer | âœ… | âŒ | âŒ | âŒ |

**æƒé™è¦æ±‚**: `VIEW_ADMIN`, `MANAGE_USERS`, `MANAGE_PROJECTS`

---

### 4.9 ç³»ç»Ÿé…ç½® (System Config)

**åŠŸèƒ½æ¦‚è¿°**: ç¯å¢ƒå˜é‡å’Œç³»ç»Ÿè®¾ç½®

**é…ç½®é¡¹**:
```mermaid
graph TD
    A[ç³»ç»Ÿé…ç½®] --> B[ç¯å¢ƒç®¡ç†]
    A --> C[åŸºæœ¬ä¿¡æ¯]
    A --> D[å®‰å…¨ä¸è®¿é—®]
    
    B --> B1[Development]
    B --> B2[Staging]
    B --> B3[Production]
    
    C --> C1[å…¬å¸åç§°]
    C --> C2[ä¸»é¢˜é¢œè‰²]
    
    D --> D1[SSOç™»å½•]
    D --> D2[å…¬å¼€æ³¨å†Œ]
```

**ç¯å¢ƒå˜é‡ç»“æ„**:
```typescript
interface Environment {
  id: "env-1",
  projectId: "proj-1",
  name: "Development",
  color: "bg-emerald-500",
  variables: [
    {
      key: "baseUrl",
      value: "https://dev.api.local",
      isSecret: false
    },
    {
      key: "apiKey",
      value: "dev-key-123",
      isSecret: true  // åŠ å¯†æ˜¾ç¤º
    }
  ]
}
```

**ç¯å¢ƒåˆ‡æ¢**:
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as ä¾§è¾¹æ 
    participant C as ConfigContext
    participant T as æµ‹è¯•æ‰§è¡Œ
    
    U->>S: é€‰æ‹©ç¯å¢ƒ "Staging"
    S->>C: setActiveEnvId("env-2")
    C->>C: æ›´æ–° activeEnv
    T->>C: è¯»å–ç¯å¢ƒå˜é‡
    C-->>T: è¿”å› Staging å˜é‡
    T->>T: æ›¿æ¢ {{baseUrl}} ç­‰å˜é‡
```

**æƒé™è¦æ±‚**: `VIEW_SETTINGS`

---


## 5. ä¸šåŠ¡æµç¨‹

### 5.1 ç”¨æˆ·ç™»å½•æµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant A as Authç»„ä»¶
    participant S as useAppState
    participant M as Main App
    
    U->>A: è¾“å…¥ç”¨æˆ·å/å¯†ç 
    A->>A: éªŒè¯å‡­è¯
    alt éªŒè¯æˆåŠŸ
        A->>S: setCurrentUser(user)
        S->>M: è§¦å‘é‡æ¸²æŸ“
        M->>M: æ£€æŸ¥ç”¨æˆ·æƒé™
        M-->>U: æ˜¾ç¤ºä¸»ç•Œé¢
    else éªŒè¯å¤±è´¥
        A-->>U: æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    end
```

**ç™»å½•é€»è¾‘**:
```typescript
// Auth.tsx
const handleLogin = (username: string, password: string) => {
  // ä» MOCK_USERS æŸ¥æ‰¾ç”¨æˆ·
  const user = MOCK_USERS.find(u => 
    u.email === username && password === 'demo'
  );
  
  if (user) {
    onLogin(user);  // è®¾ç½® currentUser
  } else {
    setError('Invalid credentials');
  }
};
```

---

### 5.2 æµ‹è¯•ç”¨ä¾‹åˆ›å»ºæµç¨‹

```mermaid
flowchart TD
    A[å¼€å§‹] --> B{åˆ›å»ºæ–¹å¼}
    B -->|æ‰‹åŠ¨åˆ›å»º| C[å¡«å†™è¡¨å•]
    B -->|AIç”Ÿæˆ| D[è¾“å…¥éœ€æ±‚æè¿°]
    
    C --> E[å®šä¹‰åŸºæœ¬ä¿¡æ¯]
    D --> F[è°ƒç”¨Gemini API]
    
    E --> G[æ·»åŠ æµ‹è¯•æ­¥éª¤]
    F --> H[è§£æAIå“åº”]
    
    G --> I{ç»‘å®šè„šæœ¬?}
    H --> G
    
    I -->|æ˜¯| J[é€‰æ‹©è„šæœ¬]
    I -->|å¦| K[çº¯æ‰‹åŠ¨æ­¥éª¤]
    
    J --> L[é…ç½®å‚æ•°æ˜ å°„]
    K --> M[ä¿å­˜ç”¨ä¾‹]
    L --> M
    
    M --> N[æ·»åŠ åˆ°æ–‡ä»¶å¤¹]
    N --> O[ç»“æŸ]
```

**AIç”Ÿæˆç¤ºä¾‹**:
```typescript
// ç”¨æˆ·è¾“å…¥
const description = "éªŒè¯ç”¨æˆ·ç™»å½•åŠŸèƒ½";

// AIç”Ÿæˆç»“æœ
{
  title: "Verify Login with Valid Credentials",
  description: "Ensure user can login with correct username and password",
  priority: "CRITICAL",
  steps: [
    {
      instruction: "Navigate to {{baseUrl}}/login",
      expectedResult: "Login form displayed"
    },
    {
      instruction: "Enter valid username",
      expectedResult: "Field populated"
    }
  ]
}
```

---

### 5.3 å·¥ä½œæµç¼–æ’æµç¨‹

```mermaid
stateDiagram-v2
    [*] --> åˆ›å»ºå·¥ä½œæµ
    åˆ›å»ºå·¥ä½œæµ --> æ·»åŠ èŠ‚ç‚¹
    
    æ·»åŠ èŠ‚ç‚¹ --> é…ç½®èŠ‚ç‚¹
    é…ç½®èŠ‚ç‚¹ --> è¿æ¥èŠ‚ç‚¹
    
    è¿æ¥èŠ‚ç‚¹ --> æ·»åŠ èŠ‚ç‚¹: ç»§ç»­æ·»åŠ 
    è¿æ¥èŠ‚ç‚¹ --> æµ‹è¯•è¿è¡Œ: å®Œæˆç¼–æ’
    
    æµ‹è¯•è¿è¡Œ --> æŸ¥çœ‹æ—¥å¿—
    æŸ¥çœ‹æ—¥å¿— --> è°ƒè¯•ä¿®æ”¹: æœ‰é”™è¯¯
    æŸ¥çœ‹æ—¥å¿— --> ä¿å­˜å‘å¸ƒ: æˆåŠŸ
    
    è°ƒè¯•ä¿®æ”¹ --> é…ç½®èŠ‚ç‚¹
    ä¿å­˜å‘å¸ƒ --> [*]
```

**èŠ‚ç‚¹é…ç½®ç¤ºä¾‹**:
```yaml
# HTTPè¯·æ±‚èŠ‚ç‚¹
- id: n4
  type: HTTP_REQUEST
  name: Sync to Jira
  config:
    method: POST
    url: "https://jira.api/v2/sync"
    headers:
      Authorization: "Bearer {{jiraToken}}"
    body:
      ticket_type: "TestRun"
      details:
        runner: "{{user.name}}"
        status: "{{n3.status}}"
    outputTransform:
      "body.ticket_id": "jiraTicketId"
```

---

### 5.4 æµ‹è¯•æ‰§è¡Œæµç¨‹

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant UI as æµ‹è¯•ç”¨ä¾‹UI
    participant E as æ‰§è¡Œå¼•æ“
    participant W as å·¥ä½œæµå¼•æ“
    participant S as è„šæœ¬æ‰§è¡Œå™¨
    participant L as æ—¥å¿—ç³»ç»Ÿ
    
    U->>UI: ç‚¹å‡»"è¿è¡Œ"
    UI->>E: æäº¤æ‰§è¡Œè¯·æ±‚
    
    alt æ‰‹åŠ¨ç”¨ä¾‹
        E->>E: é€æ­¥æ‰§è¡Œ
        E->>L: è®°å½•æ—¥å¿—
    else è‡ªåŠ¨åŒ–ç”¨ä¾‹
        E->>W: è°ƒç”¨å…³è”å·¥ä½œæµ
        W->>W: è§£æèŠ‚ç‚¹å›¾
        loop éå†èŠ‚ç‚¹
            W->>S: æ‰§è¡Œè„šæœ¬èŠ‚ç‚¹
            S-->>W: è¿”å›è¾“å‡º
            W->>W: æ›´æ–°å˜é‡ä¸Šä¸‹æ–‡
            W->>L: è®°å½•æ‰§è¡Œæ—¥å¿—
        end
        W-->>E: è¿”å›æœ€ç»ˆçŠ¶æ€
    end
    
    E->>E: ç”ŸæˆTestRunè®°å½•
    E-->>UI: è¿”å›æ‰§è¡Œç»“æœ
    UI-->>U: æ˜¾ç¤ºçŠ¶æ€å’Œæ—¥å¿—
```

**æ‰§è¡Œä¸Šä¸‹æ–‡**:
```typescript
interface ExecutionContext {
  variables: Record<string, any>;  // å…¨å±€å˜é‡
  nodeOutputs: Record<string, any>; // èŠ‚ç‚¹è¾“å‡º
  environment: Environment;         // å½“å‰ç¯å¢ƒ
  user: User;                       // æ‰§è¡Œç”¨æˆ·
}

// å˜é‡æ›¿æ¢ç¤ºä¾‹
const instruction = "Navigate to {{baseUrl}}/login";
const resolved = replaceVariables(instruction, context);
// ç»“æœ: "Navigate to https://dev.api.local/login"
```

---

### 5.5 æƒé™éªŒè¯æµç¨‹

```mermaid
flowchart TD
    A[ç”¨æˆ·æ“ä½œ] --> B{å·²ç™»å½•?}
    B -->|å¦| C[è·³è½¬ç™»å½•é¡µ]
    B -->|æ˜¯| D[è·å–ç”¨æˆ·è§’è‰²]
    
    D --> E[æŸ¥æ‰¾è§’è‰²æƒé™åˆ—è¡¨]
    E --> F{åŒ…å«æ‰€éœ€æƒé™?}
    
    F -->|æ˜¯| G[æ‰§è¡Œæ“ä½œ]
    F -->|å¦| H[æ˜¾ç¤ºAccess Denied]
    
    G --> I[æ“ä½œæˆåŠŸ]
    H --> J[è®°å½•å®¡è®¡æ—¥å¿—]
    
    C --> K[ç»“æŸ]
    I --> K
    J --> K
```

**æƒé™æ£€æŸ¥ä»£ç **:
```typescript
// usePermissions.ts
const hasPermission = (permissionCode: string): boolean => {
  if (!currentUser) return false;
  
  const userRole = roles.find(r => r.id === currentUser.roleId);
  if (!userRole) return false;
  
  return userRole.permissionCodes.includes(permissionCode);
};

// ä½¿ç”¨ç¤ºä¾‹
{currentTab === 'cases' && (
  hasPermission('VIEW_CASES') 
    ? <TestCaseManager /> 
    : <AccessDenied />
)}
```

---


## 6. æƒé™ç³»ç»Ÿ

### 6.1 RBACæ¨¡å‹

```mermaid
erDiagram
    User ||--|| Role : has
    Role ||--o{ Permission : grants
    User ||--|| Organization : belongs_to
    Organization ||--o{ Project : owns
    
    User {
        string id
        string roleId
        string orgId
    }
    
    Role {
        string id
        string name
        array permissionCodes
    }
    
    Permission {
        string code
        string name
        enum category
    }
```

**æƒé™æ¨¡å‹è¯´æ˜**:
- **User**: ç”¨æˆ·ï¼Œå±äºä¸€ä¸ªç»„ç»‡ï¼Œæ‹¥æœ‰ä¸€ä¸ªè§’è‰²
- **Role**: è§’è‰²ï¼ŒåŒ…å«å¤šä¸ªæƒé™ä»£ç 
- **Permission**: æƒé™ï¼Œå®šä¹‰å…·ä½“çš„æ“ä½œæƒé™
- **Organization**: ç»„ç»‡ï¼Œæ‹¥æœ‰å¤šä¸ªé¡¹ç›®
- **Project**: é¡¹ç›®ï¼Œæ•°æ®éš”ç¦»çš„åŸºæœ¬å•ä½

---

### 6.2 æƒé™åˆ—è¡¨

```mermaid
mindmap
  root((æƒé™åˆ†ç±»))
    èœå•æƒé™ Menu
      VIEW_DASHBOARD
      VIEW_CASES
      VIEW_AUTOMATION
      VIEW_LIBRARY
      VIEW_DATABASE
      VIEW_HISTORY
      VIEW_ADMIN
      VIEW_SETTINGS
      VIEW_DOCS
    æ“ä½œæƒé™ Action
      CREATE_CASE
      EDIT_CASE
      DELETE_CASE
      EXECUTE_RUN
      MANAGE_SCRIPTS
    ç³»ç»Ÿæƒé™ System
      MANAGE_USERS
      MANAGE_PROJECTS
```

**å®Œæ•´æƒé™è¡¨**:

| æƒé™ä»£ç  | åç§° | ç±»åˆ« | è¯´æ˜ |
|---------|------|------|------|
| VIEW_DASHBOARD | View Dashboard | Menu | è®¿é—®ä»ªè¡¨ç›˜ |
| VIEW_CASES | View Test Repository | Menu | è®¿é—®æµ‹è¯•ç”¨ä¾‹åº“ |
| VIEW_AUTOMATION | View Automation Lab | Menu | è®¿é—®è‡ªåŠ¨åŒ–å®éªŒå®¤ |
| VIEW_LIBRARY | View Action Library | Menu | è®¿é—®åŠ¨ä½œåº“ |
| VIEW_DATABASE | View Database | Menu | è®¿é—®æ•°æ®æ¨¡å‹ |
| VIEW_HISTORY | View History | Menu | è®¿é—®æ‰§è¡Œå†å² |
| VIEW_ADMIN | View Admin Portal | Menu | è®¿é—®ç®¡ç†åå° |
| VIEW_SETTINGS | View Settings | Menu | è®¿é—®ç³»ç»Ÿé…ç½® |
| VIEW_DOCS | View Documentation | Menu | è®¿é—®æ–‡æ¡£ä¸­å¿ƒ |
| CREATE_CASE | Create Test Case | Action | åˆ›å»ºæµ‹è¯•ç”¨ä¾‹ |
| EDIT_CASE | Edit Test Case | Action | ç¼–è¾‘æµ‹è¯•ç”¨ä¾‹ |
| DELETE_CASE | Delete Test Case | Action | åˆ é™¤æµ‹è¯•ç”¨ä¾‹ |
| EXECUTE_RUN | Execute Tests | Action | æ‰§è¡Œæµ‹è¯• |
| MANAGE_SCRIPTS | Manage Scripts | Action | ç®¡ç†è„šæœ¬ |
| MANAGE_USERS | Manage Users | System | ç®¡ç†ç”¨æˆ· |
| MANAGE_PROJECTS | Manage Projects | System | ç®¡ç†é¡¹ç›® |

---

### 6.3 è§’è‰²å®šä¹‰

```mermaid
graph TD
    A[è§’è‰²ä½“ç³»] --> B[Administrator]
    A --> C[Editor]
    A --> D[Viewer]
    
    B --> B1[æ‰€æœ‰æƒé™]
    
    C --> C1[æ‰€æœ‰èœå•æƒé™]
    C --> C2[æ‰€æœ‰æ“ä½œæƒé™]
    C --> C3[æ— ç³»ç»Ÿæƒé™]
    
    D --> D1[åªè¯»èœå•æƒé™]
    D --> D2[æ— æ“ä½œæƒé™]
    D --> D3[æ— ç³»ç»Ÿæƒé™]
```

**è§’è‰²æƒé™çŸ©é˜µ**:

| åŠŸèƒ½ | Administrator | Editor | Viewer |
|------|--------------|--------|--------|
| **èœå•è®¿é—®** |
| ä»ªè¡¨ç›˜ | âœ… | âœ… | âœ… |
| æµ‹è¯•ç”¨ä¾‹åº“ | âœ… | âœ… | âœ… |
| è‡ªåŠ¨åŒ–å®éªŒå®¤ | âœ… | âœ… | âœ… |
| åŠ¨ä½œåº“ | âœ… | âœ… | âœ… |
| æ•°æ®æ¨¡å‹ | âœ… | âœ… | âœ… |
| æ‰§è¡Œå†å² | âœ… | âœ… | âœ… |
| æ–‡æ¡£ä¸­å¿ƒ | âœ… | âœ… | âœ… |
| ç®¡ç†åå° | âœ… | âŒ | âŒ |
| ç³»ç»Ÿé…ç½® | âœ… | âŒ | âŒ |
| **æ“ä½œæƒé™** |
| åˆ›å»ºç”¨ä¾‹ | âœ… | âœ… | âŒ |
| ç¼–è¾‘ç”¨ä¾‹ | âœ… | âœ… | âŒ |
| åˆ é™¤ç”¨ä¾‹ | âœ… | âœ… | âŒ |
| æ‰§è¡Œæµ‹è¯• | âœ… | âœ… | âŒ |
| ç®¡ç†è„šæœ¬ | âœ… | âœ… | âŒ |
| **ç³»ç»Ÿæƒé™** |
| ç®¡ç†ç”¨æˆ· | âœ… | âŒ | âŒ |
| ç®¡ç†é¡¹ç›® | âœ… | âŒ | âŒ |

**è§’è‰²å®šä¹‰ä»£ç **:
```typescript
export const MOCK_ROLES: Role[] = [
  {
    id: 'admin',
    name: 'Administrator',
    permissionCodes: [
      // æ‰€æœ‰æƒé™
      'VIEW_DASHBOARD', 'VIEW_CASES', 'VIEW_AUTOMATION',
      'VIEW_LIBRARY', 'VIEW_DATABASE', 'VIEW_HISTORY',
      'VIEW_ADMIN', 'VIEW_SETTINGS', 'VIEW_DOCS',
      'CREATE_CASE', 'EDIT_CASE', 'DELETE_CASE',
      'EXECUTE_RUN', 'MANAGE_SCRIPTS',
      'MANAGE_USERS', 'MANAGE_PROJECTS'
    ],
    description: 'Full system access'
  },
  {
    id: 'editor',
    name: 'Editor',
    permissionCodes: [
      // èœå•æƒé™ï¼ˆé™¤ç®¡ç†åå°å’Œç³»ç»Ÿé…ç½®ï¼‰
      'VIEW_DASHBOARD', 'VIEW_CASES', 'VIEW_AUTOMATION',
      'VIEW_LIBRARY', 'VIEW_DATABASE', 'VIEW_HISTORY', 'VIEW_DOCS',
      // æ“ä½œæƒé™
      'CREATE_CASE', 'EDIT_CASE', 'DELETE_CASE',
      'EXECUTE_RUN', 'MANAGE_SCRIPTS'
    ],
    description: 'Can manage test cases and execute runs'
  },
  {
    id: 'viewer',
    name: 'Viewer',
    permissionCodes: [
      // åªè¯»èœå•æƒé™
      'VIEW_DASHBOARD', 'VIEW_CASES', 'VIEW_AUTOMATION',
      'VIEW_LIBRARY', 'VIEW_DATABASE', 'VIEW_HISTORY', 'VIEW_DOCS'
    ],
    description: 'Read-only access to dashboards and reports'
  }
];
```

---

### 6.4 å¤šç§Ÿæˆ·æ¶æ„

```mermaid
graph TB
    subgraph "ç§Ÿæˆ·å±‚çº§"
        A[Organization 1<br/>Acme Corp Global] --> B[Project 1<br/>E-Commerce Core]
        A --> C[Project 2<br/>Mobile App]
        
        D[Organization 2<br/>Startup Inc] --> E[Project 3<br/>Website MVP]
    end
    
    subgraph "æ•°æ®éš”ç¦»"
        B --> F[TestCase<br/>projectId=proj-1]
        B --> G[Script<br/>projectId=proj-1]
        B --> H[Workflow<br/>projectId=proj-1]
        
        C --> I[TestCase<br/>projectId=proj-2]
        
        E --> J[TestCase<br/>projectId=proj-3]
    end
    
    subgraph "ç”¨æˆ·è®¿é—®"
        K[User: Alice<br/>orgId=org-1] -.å¯è®¿é—®.-> B
        K -.å¯è®¿é—®.-> C
        
        L[User: Charlie<br/>orgId=org-2] -.å¯è®¿é—®.-> E
    end
```

**æ•°æ®éš”ç¦»å®ç°**:
```typescript
// useAppState.ts
const activeProjectCases = cases.filter(c => 
  c.projectId === activeProjectId
);

const activeProjectScripts = scripts.filter(s => 
  s.projectId === activeProjectId
);

const activeProjectWorkflows = workflows.filter(w => 
  w.projectId === activeProjectId
);
```

**åˆ‡æ¢é¡¹ç›®æµç¨‹**:
```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant S as ä¾§è¾¹æ 
    participant A as useAppState
    participant UI as ä¸šåŠ¡ç»„ä»¶
    
    U->>S: é€‰æ‹©é¡¹ç›® "Mobile App"
    S->>A: setActiveProjectId("proj-2")
    A->>A: è¿‡æ»¤æ•°æ®
    A->>A: åˆ‡æ¢ç¯å¢ƒåˆ°è¯¥é¡¹ç›®
    A-->>UI: è§¦å‘é‡æ¸²æŸ“
    UI->>UI: æ˜¾ç¤ºæ–°é¡¹ç›®æ•°æ®
    UI-->>U: æ›´æ–°ç•Œé¢
```

**ç§Ÿæˆ·éš”ç¦»è§„åˆ™**:
1. **ç»„ç»‡çº§éš”ç¦»**: ç”¨æˆ·åªèƒ½è®¿é—®æ‰€å±ç»„ç»‡çš„é¡¹ç›®
2. **é¡¹ç›®çº§éš”ç¦»**: æ‰€æœ‰ä¸šåŠ¡æ•°æ®æŒ‰ `projectId` è¿‡æ»¤
3. **ç¯å¢ƒéš”ç¦»**: æ¯ä¸ªé¡¹ç›®æœ‰ç‹¬ç«‹çš„ç¯å¢ƒé…ç½®
4. **æƒé™ç»§æ‰¿**: ç”¨æˆ·æƒé™åœ¨æ‰€æœ‰é¡¹ç›®ä¸­ä¸€è‡´

---


## 7. APIæ¥å£

### 7.1 æ¥å£è®¾è®¡åŸåˆ™

**å½“å‰çŠ¶æ€**: å‰ç«¯ä½¿ç”¨ Mock Dataï¼Œæœªå®ç°çœŸå®åç«¯API

**æœªæ¥APIè®¾è®¡åŸåˆ™**:
```mermaid
graph LR
    A[RESTful API] --> B[ç»Ÿä¸€å“åº”æ ¼å¼]
    A --> C[JWTè®¤è¯]
    A --> D[RBACé‰´æƒ]
    A --> E[å¤šç§Ÿæˆ·éš”ç¦»]
    
    B --> B1[æˆåŠŸ: 200]
    B --> B2[é”™è¯¯: 4xx/5xx]
    
    C --> C1[Tokenåˆ·æ–°]
    C --> C2[è¿‡æœŸå¤„ç†]
    
    D --> D1[æƒé™éªŒè¯]
    D --> D2[å®¡è®¡æ—¥å¿—]
    
    E --> E1[Header: X-Project-Id]
    E --> E2[æ•°æ®è¿‡æ»¤]
```

---

### 7.2 æ ¸å¿ƒæ¥å£åˆ—è¡¨

**è®¤è¯æ¥å£**:
```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "alice@company.com",
  "password": "password123"
}

Response:
{
  "success": true,
  "data": {
    "user": { "id": "u1", "name": "Alice", "roleId": "admin" },
    "token": "eyJhbGciOiJIUzI1NiIs...",
    "expiresIn": 3600
  }
}
```

**æµ‹è¯•ç”¨ä¾‹æ¥å£**:
```mermaid
sequenceDiagram
    participant C as Client
    participant A as API Gateway
    participant S as Service
    participant D as Database
    
    C->>A: GET /api/cases?projectId=proj-1
    A->>A: éªŒè¯Token
    A->>A: æ£€æŸ¥æƒé™ VIEW_CASES
    A->>S: è½¬å‘è¯·æ±‚
    S->>D: SELECT * FROM test_cases WHERE project_id='proj-1'
    D-->>S: è¿”å›æ•°æ®
    S-->>A: è¿”å›ç»“æœ
    A-->>C: JSONå“åº”
```

**æ¥å£åˆ—è¡¨**:

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ | æƒé™ |
|------|------|------|------|
| **è®¤è¯** |
| POST | /api/auth/login | ç”¨æˆ·ç™»å½• | - |
| POST | /api/auth/logout | ç”¨æˆ·ç™»å‡º | - |
| POST | /api/auth/refresh | åˆ·æ–°Token | - |
| **æµ‹è¯•ç”¨ä¾‹** |
| GET | /api/cases | è·å–ç”¨ä¾‹åˆ—è¡¨ | VIEW_CASES |
| POST | /api/cases | åˆ›å»ºç”¨ä¾‹ | CREATE_CASE |
| GET | /api/cases/:id | è·å–ç”¨ä¾‹è¯¦æƒ… | VIEW_CASES |
| PUT | /api/cases/:id | æ›´æ–°ç”¨ä¾‹ | EDIT_CASE |
| DELETE | /api/cases/:id | åˆ é™¤ç”¨ä¾‹ | DELETE_CASE |
| **è„šæœ¬** |
| GET | /api/scripts | è·å–è„šæœ¬åˆ—è¡¨ | VIEW_LIBRARY |
| POST | /api/scripts | åˆ›å»ºè„šæœ¬ | MANAGE_SCRIPTS |
| PUT | /api/scripts/:id | æ›´æ–°è„šæœ¬ | MANAGE_SCRIPTS |
| DELETE | /api/scripts/:id | åˆ é™¤è„šæœ¬ | MANAGE_SCRIPTS |
| POST | /api/scripts/:id/test | æµ‹è¯•è„šæœ¬ | MANAGE_SCRIPTS |
| **å·¥ä½œæµ** |
| GET | /api/workflows | è·å–å·¥ä½œæµåˆ—è¡¨ | VIEW_AUTOMATION |
| POST | /api/workflows | åˆ›å»ºå·¥ä½œæµ | MANAGE_SCRIPTS |
| PUT | /api/workflows/:id | æ›´æ–°å·¥ä½œæµ | MANAGE_SCRIPTS |
| POST | /api/workflows/:id/execute | æ‰§è¡Œå·¥ä½œæµ | EXECUTE_RUN |
| **æ‰§è¡Œå†å²** |
| GET | /api/runs | è·å–æ‰§è¡Œè®°å½• | VIEW_HISTORY |
| GET | /api/runs/:id | è·å–æ‰§è¡Œè¯¦æƒ… | VIEW_HISTORY |
| **ç”¨æˆ·ç®¡ç†** |
| GET | /api/users | è·å–ç”¨æˆ·åˆ—è¡¨ | MANAGE_USERS |
| POST | /api/users | åˆ›å»ºç”¨æˆ· | MANAGE_USERS |
| PUT | /api/users/:id | æ›´æ–°ç”¨æˆ· | MANAGE_USERS |
| DELETE | /api/users/:id | åˆ é™¤ç”¨æˆ· | MANAGE_USERS |

---

### 7.3 æ•°æ®äº¤äº’æ ¼å¼

**ç»Ÿä¸€å“åº”æ ¼å¼**:
```typescript
interface ApiResponse<T> {
  success: boolean;
  data?: T;
  error?: {
    code: string;
    message: string;
    details?: any;
  };
  meta?: {
    page: number;
    pageSize: number;
    total: number;
  };
}
```

**æˆåŠŸå“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": {
    "id": "TC-101",
    "title": "Verify Login",
    "priority": "CRITICAL",
    "steps": [...]
  }
}
```

**é”™è¯¯å“åº”ç¤ºä¾‹**:
```json
{
  "success": false,
  "error": {
    "code": "PERMISSION_DENIED",
    "message": "You don't have permission to perform this action",
    "details": {
      "required": "CREATE_CASE",
      "current": ["VIEW_CASES", "VIEW_DASHBOARD"]
    }
  }
}
```

**åˆ†é¡µå“åº”ç¤ºä¾‹**:
```json
{
  "success": true,
  "data": [
    { "id": "TC-101", "title": "..." },
    { "id": "TC-102", "title": "..." }
  ],
  "meta": {
    "page": 1,
    "pageSize": 20,
    "total": 156
  }
}
```

---


## 8. å·¥ä½œæµå¼•æ“

### 8.1 èŠ‚ç‚¹ç±»å‹

```mermaid
classDiagram
    class WorkflowNode {
        +string id
        +NodeType type
        +string name
        +NodeConfig config
        +WorkflowNode[] children
        +WorkflowNode[] elseChildren
    }
    
    class NodeType {
        <<enumeration>>
        TEST_CASE
        STEP
        SCRIPT
        LOOP
        CONDITION
        HTTP_REQUEST
        DB_QUERY
        REDIS_CMD
        KAFKA_PUB
        BROWSER_ACTION
        LLM_PROMPT
        CALL_WORKFLOW
    }
    
    WorkflowNode --> NodeType
```

**èŠ‚ç‚¹åˆ†ç±»è¯¦è§£**:

| ç±»åˆ« | èŠ‚ç‚¹ç±»å‹ | è¯´æ˜ | é…ç½®é¡¹ |
|------|---------|------|--------|
| **æµ‹è¯•** | TEST_CASE | æ‰§è¡Œå®Œæ•´æµ‹è¯•ç”¨ä¾‹ | referenceId |
| | STEP | æ‰§è¡Œå•ä¸ªæµ‹è¯•æ­¥éª¤ | referenceId, stepId |
| **è„šæœ¬** | SCRIPT | æ‰§è¡Œè‡ªå®šä¹‰è„šæœ¬ | scriptId, inputs |
| **æ§åˆ¶æµ** | LOOP | å¾ªç¯æ‰§è¡Œ | loopCount, loopOver |
| | CONDITION | æ¡ä»¶åˆ†æ”¯ | condition |
| | CALL_WORKFLOW | è°ƒç”¨å­å·¥ä½œæµ | targetWorkflowId, inputs |
| **é›†æˆ** | HTTP_REQUEST | HTTPè¯·æ±‚ | url, method, headers, body |
| | RPC_CALL | RPCè°ƒç”¨ | service, rpcMethod |
| | MCP_TOOL | MCPå·¥å…·è°ƒç”¨ | mcpServer, mcpToolName |
| **æ•°æ®** | DB_QUERY | æ•°æ®åº“æŸ¥è¯¢ | sql, dbType |
| | REDIS_CMD | Rediså‘½ä»¤ | redisCommand, redisKey |
| | ES_QUERY | ESæŸ¥è¯¢ | esIndex, esQuery |
| **æ¶ˆæ¯** | KAFKA_PUB | Kafkaå‘å¸ƒ | kafkaTopic, kafkaMessage |
| **ç³»ç»Ÿ** | SHELL_CMD | Shellå‘½ä»¤ | shellCommand, shellCwd |
| | BROWSER_ACTION | æµè§ˆå™¨æ“ä½œ | browserCommand, selector |
| **AI** | LLM_PROMPT | AIæç¤º | prompt, model |

---

### 8.2 æ‰§è¡Œé€»è¾‘

```mermaid
flowchart TD
    A[å¼€å§‹æ‰§è¡Œ] --> B[åˆå§‹åŒ–ä¸Šä¸‹æ–‡]
    B --> C[åŠ è½½ç¯å¢ƒå˜é‡]
    C --> D[éå†èŠ‚ç‚¹åˆ—è¡¨]
    
    D --> E{èŠ‚ç‚¹ç±»å‹}
    
    E -->|SCRIPT| F[æ‰§è¡Œè„šæœ¬]
    E -->|CONDITION| G[è¯„ä¼°æ¡ä»¶]
    E -->|LOOP| H[å¾ªç¯æ‰§è¡Œ]
    E -->|HTTP_REQUEST| I[å‘é€HTTPè¯·æ±‚]
    E -->|CALL_WORKFLOW| J[è°ƒç”¨å­å·¥ä½œæµ]
    
    F --> K[æ›´æ–°ä¸Šä¸‹æ–‡]
    G --> L{æ¡ä»¶ç»“æœ}
    L -->|True| M[æ‰§è¡Œchildren]
    L -->|False| N[æ‰§è¡ŒelseChildren]
    
    H --> O[éå†å¾ªç¯ä½“]
    O --> P{ç»§ç»­å¾ªç¯?}
    P -->|æ˜¯| O
    P -->|å¦| K
    
    I --> K
    J --> K
    M --> K
    N --> K
    
    K --> Q{è¿˜æœ‰èŠ‚ç‚¹?}
    Q -->|æ˜¯| D
    Q -->|å¦| R[ç”Ÿæˆæ‰§è¡ŒæŠ¥å‘Š]
    R --> S[ç»“æŸ]
```

**æ‰§è¡Œå¼•æ“ä¼ªä»£ç **:
```typescript
async function executeWorkflow(workflow: Workflow, context: ExecutionContext) {
  const logs: string[] = [];
  
  for (const node of workflow.nodes) {
    try {
      switch (node.type) {
        case NodeType.SCRIPT:
          const scriptResult = await executeScript(node.config.scriptId, context);
          context.nodeOutputs[node.id] = scriptResult;
          logs.push(`âœ“ ${node.name}: Success`);
          break;
          
        case NodeType.CONDITION:
          const conditionResult = evaluateCondition(node.config.condition, context);
          if (conditionResult) {
            await executeNodes(node.children, context);
          } else {
            await executeNodes(node.elseChildren, context);
          }
          break;
          
        case NodeType.LOOP:
          const loopData = resolveVariable(node.config.loopOver, context);
          for (const item of loopData) {
            context.variables['item'] = item;
            await executeNodes(node.children, context);
          }
          break;
          
        case NodeType.HTTP_REQUEST:
          const httpResult = await sendHttpRequest(node.config, context);
          context.nodeOutputs[node.id] = httpResult;
          break;
          
        // ... å…¶ä»–èŠ‚ç‚¹ç±»å‹
      }
    } catch (error) {
      logs.push(`âœ— ${node.name}: ${error.message}`);
      throw error;
    }
  }
  
  return { status: 'PASSED', logs };
}
```

---

### 8.3 å˜é‡ç³»ç»Ÿ

```mermaid
graph TB
    A[å˜é‡æ¥æº] --> B[ç¯å¢ƒå˜é‡]
    A --> C[ç”¨ä¾‹å˜é‡]
    A --> D[èŠ‚ç‚¹è¾“å‡º]
    A --> E[å…¨å±€è¾“å…¥]
    
    B --> F[å˜é‡æ± ]
    C --> F
    D --> F
    E --> F
    
    F --> G[å˜é‡è§£æå™¨]
    G --> H[æ›¿æ¢ {{var}}]
    H --> I[æ‰§è¡ŒèŠ‚ç‚¹]
```

**å˜é‡ä¼˜å…ˆçº§**:
1. èŠ‚ç‚¹è¾“å‡º (æœ€é«˜ä¼˜å…ˆçº§)
2. ç”¨ä¾‹å˜é‡
3. ç¯å¢ƒå˜é‡
4. å…¨å±€è¾“å…¥ (æœ€ä½ä¼˜å…ˆçº§)

**å˜é‡ä½¿ç”¨ç¤ºä¾‹**:
```typescript
// ç¯å¢ƒå˜é‡
environment.variables = {
  baseUrl: "https://api.example.com",
  apiKey: "secret-key-123"
};

// ç”¨ä¾‹å˜é‡
testCase.variables = {
  testUser: "admin_01",
  itemPrice: "10.00"
};

// èŠ‚ç‚¹è¾“å‡º
nodeOutputs = {
  "n1": { userId: "user-123", token: "abc..." },
  "n2": { orderId: "order-456" }
};

// å˜é‡æ›¿æ¢
const url = "{{baseUrl}}/users/{{n1.userId}}";
// è§£æå: "https://api.example.com/users/user-123"

const instruction = "Add Item A (${{itemPrice}}) to cart";
// è§£æå: "Add Item A ($10.00) to cart"
```

**è¾“å‡ºæ˜ å°„**:
```typescript
// æ­¥éª¤é…ç½®
{
  linkedScriptId: "sc-1",
  outputMapping: {
    "userId": "currentUser",      // è„šæœ¬è¾“å‡º -> å˜é‡å
    "status": "dbStatus"
  }
}

// æ‰§è¡Œå
context.variables.currentUser = scriptOutput.userId;
context.variables.dbStatus = scriptOutput.status;
```

---

### 8.4 é”™è¯¯å¤„ç†

```mermaid
stateDiagram-v2
    [*] --> æ‰§è¡ŒèŠ‚ç‚¹
    æ‰§è¡ŒèŠ‚ç‚¹ --> æˆåŠŸ: æ— å¼‚å¸¸
    æ‰§è¡ŒèŠ‚ç‚¹ --> å¤±è´¥: æŠ›å‡ºå¼‚å¸¸
    
    æˆåŠŸ --> è®°å½•æ—¥å¿—
    å¤±è´¥ --> æ•è·é”™è¯¯
    
    æ•è·é”™è¯¯ --> è®°å½•é”™è¯¯æ—¥å¿—
    è®°å½•é”™è¯¯æ—¥å¿— --> æ£€æŸ¥é‡è¯•ç­–ç•¥
    
    æ£€æŸ¥é‡è¯•ç­–ç•¥ --> é‡è¯•: å¯é‡è¯•
    æ£€æŸ¥é‡è¯•ç­–ç•¥ --> æ ‡è®°å¤±è´¥: ä¸å¯é‡è¯•
    
    é‡è¯• --> æ‰§è¡ŒèŠ‚ç‚¹
    æ ‡è®°å¤±è´¥ --> åœæ­¢å·¥ä½œæµ
    
    è®°å½•æ—¥å¿— --> ä¸‹ä¸€ä¸ªèŠ‚ç‚¹
    ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ --> [*]
    åœæ­¢å·¥ä½œæµ --> [*]
```

**é”™è¯¯ç±»å‹**:
```typescript
enum ErrorType {
  NETWORK_ERROR = 'NETWORK_ERROR',      // ç½‘ç»œé”™è¯¯
  TIMEOUT = 'TIMEOUT',                  // è¶…æ—¶
  SCRIPT_ERROR = 'SCRIPT_ERROR',        // è„šæœ¬æ‰§è¡Œé”™è¯¯
  VALIDATION_ERROR = 'VALIDATION_ERROR', // éªŒè¯é”™è¯¯
  PERMISSION_DENIED = 'PERMISSION_DENIED' // æƒé™æ‹’ç»
}

interface ExecutionError {
  type: ErrorType;
  nodeId: string;
  nodeName: string;
  message: string;
  stack?: string;
  retryable: boolean;
}
```

**é”™è¯¯å¤„ç†ç­–ç•¥**:
1. **ç«‹å³å¤±è´¥**: é‡åˆ°é”™è¯¯ç«‹å³åœæ­¢æ•´ä¸ªå·¥ä½œæµ
2. **ç»§ç»­æ‰§è¡Œ**: è®°å½•é”™è¯¯ä½†ç»§ç»­æ‰§è¡Œåç»­èŠ‚ç‚¹
3. **é‡è¯•æœºåˆ¶**: å¯¹å¯é‡è¯•çš„é”™è¯¯è¿›è¡ŒNæ¬¡é‡è¯•
4. **é™çº§å¤„ç†**: æ‰§è¡Œå¤‡ç”¨é€»è¾‘

**æ—¥å¿—è®°å½•**:
```typescript
interface ExecutionLog {
  timestamp: string;
  level: 'INFO' | 'WARN' | 'ERROR';
  nodeId: string;
  nodeName: string;
  message: string;
  data?: any;
}

// æ—¥å¿—ç¤ºä¾‹
[
  {
    timestamp: "2025-11-22T10:30:00Z",
    level: "INFO",
    nodeId: "n1",
    nodeName: "DataSetup.py",
    message: "Script executed successfully",
    data: { userId: "user-123" }
  },
  {
    timestamp: "2025-11-22T10:30:05Z",
    level: "ERROR",
    nodeId: "n2",
    nodeName: "Check Environment",
    message: "Condition evaluation failed",
    data: { condition: "env.isReady == true", actual: false }
  }
]
```

---


## 9. AIé›†æˆ

### 9.1 GeminiæœåŠ¡

**æœåŠ¡æ¶æ„**:
```mermaid
graph LR
    A[NexTest Pro] --> B[geminiService.ts]
    B --> C[Google Gemini API]
    
    B --> B1[generateTestCase]
    B --> B2[analyzeTestReport]
    B --> B3[chatWithCopilot]
    
    C --> D[gemini-2.5-flash]
```

**APIé…ç½®**:
```typescript
// vite.config.ts
define: {
  'process.env.API_KEY': JSON.stringify(env.GEMINI_API_KEY),
  'process.env.GEMINI_API_KEY': JSON.stringify(env.GEMINI_API_KEY)
}

// geminiService.ts
const getClient = () => {
  const apiKey = process.env.API_KEY;
  if (!apiKey) {
    console.warn("API_KEY is missing. AI features will not work.");
    return null;
  }
  return new GoogleGenAI({ apiKey });
};
```

---

### 9.2 AIåŠŸèƒ½åˆ—è¡¨

**1. æµ‹è¯•ç”¨ä¾‹ç”Ÿæˆ**

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant UI as æµ‹è¯•ç”¨ä¾‹UI
    participant S as geminiService
    participant G as Gemini API
    
    U->>UI: ç‚¹å‡»"AIç”Ÿæˆ"
    UI->>UI: æ˜¾ç¤ºè¾“å…¥æ¡†
    U->>UI: è¾“å…¥éœ€æ±‚æè¿°
    UI->>S: generateTestCase(description)
    S->>G: å‘é€Prompt + Schema
    G->>G: ç”Ÿæˆç»“æ„åŒ–è¾“å‡º
    G-->>S: è¿”å›JSON
    S->>S: è§£æå¹¶æ˜ å°„
    S-->>UI: è¿”å›TestCaseå¯¹è±¡
    UI-->>U: æ˜¾ç¤ºç”Ÿæˆçš„ç”¨ä¾‹
```

**Promptæ¨¡æ¿**:
```typescript
const prompt = `Generate a scientific software test case based on this requirement: "${description}". 
Include a title, a summary description, priority (Low, Medium, High, Critical), and a list of steps with expected results.`;

const responseSchema = {
  type: Type.OBJECT,
  properties: {
    title: { type: Type.STRING },
    description: { type: Type.STRING },
    priority: { type: Type.STRING, enum: ["Low", "Medium", "High", "Critical"] },
    steps: {
      type: Type.ARRAY,
      items: {
        type: Type.OBJECT,
        properties: {
          instruction: { type: Type.STRING },
          expectedResult: { type: Type.STRING }
        }
      }
    }
  }
};
```

**ç”Ÿæˆç¤ºä¾‹**:
```typescript
// è¾“å…¥
description = "éªŒè¯ç”¨æˆ·ç™»å½•åŠŸèƒ½";

// AIç”Ÿæˆè¾“å‡º
{
  title: "Verify Login with Valid Credentials",
  description: "Ensure user can login with correct username and password",
  priority: "CRITICAL",
  steps: [
    {
      instruction: "Navigate to {{baseUrl}}/login",
      expectedResult: "Login form displayed"
    },
    {
      instruction: "Enter valid username",
      expectedResult: "Field populated"
    },
    {
      instruction: "Enter valid password",
      expectedResult: "Field populated (masked)"
    },
    {
      instruction: "Click Login button",
      expectedResult: "Redirected to Dashboard"
    }
  ]
}
```

**2. æµ‹è¯•æŠ¥å‘Šåˆ†æ**

```mermaid
flowchart LR
    A[æ‰§è¡Œæ‘˜è¦] --> B[analyzeTestReport]
    B --> C[Geminiåˆ†æ]
    C --> D[é£é™©è¯„ä¼°]
    C --> E[æ”¹è¿›å»ºè®®]
    C --> F[ä¸‹ä¸€æ­¥è¡ŒåŠ¨]
    
    D --> G[AIæ™ºèƒ½æ€»ç»“]
    E --> G
    F --> G
```

**åˆ†æç¤ºä¾‹**:
```typescript
// è¾“å…¥
const summary = `
Total: 10 tests
Passed: 7
Failed: 3
- TC-102: Cart calculation off by $1
- TC-105: Payment gateway timeout
- TC-108: Email notification not sent
`;

// AIè¾“å‡º
"âš ï¸ 3 critical failures detected. Cart calculation bug affects checkout flow. 
Payment timeout suggests infrastructure issue. 
Recommend: Fix cart logic, investigate gateway latency, check email service config."
```

**3. æ™ºèƒ½é—®ç­”åŠ©æ‰‹**

```mermaid
sequenceDiagram
    participant U as ç”¨æˆ·
    participant C as Copilot UI
    participant S as geminiService
    participant G as Gemini API
    
    U->>C: è¾“å…¥é—®é¢˜
    C->>C: æ”¶é›†æ‰§è¡Œæ—¥å¿—
    C->>S: chatWithCopilot(logs, question)
    S->>G: å‘é€ä¸Šä¸‹æ–‡ + é—®é¢˜
    G->>G: åˆ†ææ—¥å¿—
    G->>G: ç”Ÿæˆå›ç­”
    G-->>S: è¿”å›ç­”æ¡ˆ
    S-->>C: è¿”å›æ–‡æœ¬
    C-->>U: æ˜¾ç¤ºå›ç­”
```

**å¯¹è¯ç¤ºä¾‹**:
```typescript
// ä¸Šä¸‹æ–‡æ—¥å¿—
const logs = [
  "> Step 1: Navigate to login - PASSED",
  "> Step 2: Enter credentials - PASSED",
  "> Step 3: Click login - FAILED",
  "Error: Element not found: #login-button"
];

// ç”¨æˆ·é—®é¢˜
const question = "ä¸ºä»€ä¹ˆç™»å½•æŒ‰é’®æ‰¾ä¸åˆ°ï¼Ÿ";

// AIå›ç­”
"æ ¹æ®æ—¥å¿—ï¼Œç™»å½•æŒ‰é’®çš„é€‰æ‹©å™¨ #login-button æ— æ³•å®šä½ã€‚å¯èƒ½åŸå› ï¼š
1. é¡µé¢åŠ è½½æœªå®Œæˆï¼Œå»ºè®®æ·»åŠ ç­‰å¾…
2. é€‰æ‹©å™¨é”™è¯¯ï¼Œæ£€æŸ¥å®é™…DOMç»“æ„
3. æŒ‰é’®è¢«åŠ¨æ€æ¸²æŸ“ï¼Œéœ€è¦ç­‰å¾…AJAXå®Œæˆ
å»ºè®®ä½¿ç”¨ waitForSelector æˆ–æ›´æ–°é€‰æ‹©å™¨ã€‚"
```

---

### 9.3 ä½¿ç”¨åœºæ™¯

```mermaid
mindmap
  root((AIåº”ç”¨åœºæ™¯))
    æµ‹è¯•è®¾è®¡
      éœ€æ±‚è½¬ç”¨ä¾‹
      è¾¹ç•Œå€¼ç”Ÿæˆ
      å¼‚å¸¸åœºæ™¯è¡¥å……
    æ‰§è¡Œåˆ†æ
      å¤±è´¥åŸå› è¯Šæ–­
      æ€§èƒ½ç“¶é¢ˆè¯†åˆ«
      è¶‹åŠ¿é¢„æµ‹
    çŸ¥è¯†ç®¡ç†
      æ–‡æ¡£è‡ªåŠ¨ç”Ÿæˆ
      æœ€ä½³å®è·µæ¨è
      é—®é¢˜è§£ç­”
    æ™ºèƒ½ä¼˜åŒ–
      ç”¨ä¾‹å»é‡
      è„šæœ¬é‡æ„å»ºè®®
      å·¥ä½œæµä¼˜åŒ–
```

**æœ€ä½³å®è·µ**:

1. **ç”¨ä¾‹ç”Ÿæˆ**
   - æä¾›æ¸…æ™°çš„éœ€æ±‚æè¿°
   - åŒ…å«å…³é”®ä¸šåŠ¡è§„åˆ™
   - æŒ‡å®šä¼˜å…ˆçº§å’Œæ ‡ç­¾

2. **æŠ¥å‘Šåˆ†æ**
   - å®šæœŸåˆ†ææ‰§è¡Œè¶‹åŠ¿
   - å…³æ³¨é‡å¤å¤±è´¥çš„ç”¨ä¾‹
   - ç»“åˆAIå»ºè®®åˆ¶å®šæ”¹è¿›è®¡åˆ’

3. **æ™ºèƒ½é—®ç­”**
   - æä¾›å®Œæ•´çš„æ—¥å¿—ä¸Šä¸‹æ–‡
   - é—®é¢˜æè¿°å…·ä½“æ˜ç¡®
   - ç»“åˆAIå»ºè®®è¿›è¡Œè°ƒè¯•

**é™åˆ¶ä¸æ³¨æ„äº‹é¡¹**:
- âš ï¸ éœ€è¦é…ç½® `GEMINI_API_KEY` ç¯å¢ƒå˜é‡
- âš ï¸ APIè°ƒç”¨æœ‰é…é¢é™åˆ¶
- âš ï¸ ç”Ÿæˆçš„ç”¨ä¾‹éœ€è¦äººå·¥å®¡æ ¸
- âš ï¸ AIåˆ†æä»…ä¾›å‚è€ƒï¼Œä¸èƒ½å®Œå…¨ä¾èµ–

---


## 10. éƒ¨ç½²è¿ç»´

### 10.1 ç¯å¢ƒè¦æ±‚

**å¼€å‘ç¯å¢ƒ**:
```mermaid
graph LR
    A[å¼€å‘ç¯å¢ƒ] --> B[Node.js >= 18]
    A --> C[pnpm >= 8]
    A --> D[ç°ä»£æµè§ˆå™¨]
    
    B --> B1[æ¨è Node 20 LTS]
    C --> C1[åŒ…ç®¡ç†å™¨]
    D --> D1[Chrome/Edge/Firefox]
```

**ç³»ç»Ÿè¦æ±‚**:
| ç»„ä»¶ | æœ€ä½ç‰ˆæœ¬ | æ¨èç‰ˆæœ¬ |
|------|---------|---------|
| Node.js | 18.0.0 | 20.x LTS |
| pnpm | 8.0.0 | æœ€æ–°ç‰ˆ |
| æµè§ˆå™¨ | Chrome 90+ | æœ€æ–°ç‰ˆ |
| å†…å­˜ | 2GB | 4GB+ |
| ç£ç›˜ | 500MB | 1GB+ |

---

### 10.2 éƒ¨ç½²æµç¨‹

**æœ¬åœ°å¼€å‘éƒ¨ç½²**:
```mermaid
flowchart TD
    A[å…‹éš†ä»£ç ] --> B[å®‰è£…ä¾èµ–]
    B --> C[é…ç½®ç¯å¢ƒå˜é‡]
    C --> D[å¯åŠ¨å¼€å‘æœåŠ¡å™¨]
    D --> E[è®¿é—®åº”ç”¨]
    
    B --> B1[pnpm install]
    C --> C1[åˆ›å»º .env æ–‡ä»¶]
    C1 --> C2[è®¾ç½® GEMINI_API_KEY]
    D --> D1[pnpm run dev]
    E --> E1[http://localhost:3000]
```

**éƒ¨ç½²æ­¥éª¤**:
```bash
# 1. å…‹éš†ä»“åº“
git clone <repository-url>
cd NextTestPlatformUI

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. é…ç½®ç¯å¢ƒå˜é‡
cat > .env << EOF
GEMINI_API_KEY=your-api-key-here
EOF

# 4. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm run dev

# 5. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run build

# 6. é¢„è§ˆç”Ÿäº§æ„å»º
pnpm run preview
```

**ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**:
```mermaid
graph TB
    A[æºä»£ç ] --> B[æ„å»º]
    B --> C[ç”Ÿæˆé™æ€æ–‡ä»¶]
    C --> D[éƒ¨ç½²åˆ°æœåŠ¡å™¨]
    
    D --> E[Nginx]
    D --> F[Vercel]
    D --> G[Netlify]
    D --> H[AWS S3 + CloudFront]
    
    E --> I[é…ç½®åå‘ä»£ç†]
    F --> J[è‡ªåŠ¨éƒ¨ç½²]
    G --> J
    H --> K[CDNåŠ é€Ÿ]
```

**Nginxé…ç½®ç¤ºä¾‹**:
```nginx
server {
    listen 80;
    server_name nextest.example.com;
    
    root /var/www/nextest/dist;
    index index.html;
    
    # SPAè·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # APIä»£ç†ï¼ˆå¦‚æœæœ‰åç«¯ï¼‰
    location /api/ {
        proxy_pass http://localhost:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

---

### 10.3 é…ç½®è¯´æ˜

**ç¯å¢ƒå˜é‡**:
```bash
# .env æ–‡ä»¶
GEMINI_API_KEY=your-gemini-api-key-here

# å¯é€‰é…ç½®
VITE_API_BASE_URL=https://api.example.com
VITE_APP_TITLE=NexTest Pro
VITE_ENABLE_MOCK=false
```

**Viteé…ç½®**:
```typescript
// vite.config.ts
export default defineConfig(({ mode }) => {
  const env = loadEnv(mode, '.', '');
  return {
    server: {
      port: 3000,
      host: '0.0.0.0',  // å…è®¸å¤–éƒ¨è®¿é—®
    },
    plugins: [react()],
    define: {
      'process.env.API_KEY': JSON.stringify(env.GEMINI_API_KEY),
    },
    build: {
      outDir: 'dist',
      sourcemap: mode === 'development',
      minify: 'terser',
      rollupOptions: {
        output: {
          manualChunks: {
            'react-vendor': ['react', 'react-dom'],
            'chart-vendor': ['recharts'],
          }
        }
      }
    }
  };
});
```

**å¤šç¯å¢ƒé…ç½®**:
```bash
# .env.development
VITE_API_BASE_URL=http://localhost:8080
VITE_ENABLE_MOCK=true

# .env.staging
VITE_API_BASE_URL=https://staging-api.example.com
VITE_ENABLE_MOCK=false

# .env.production
VITE_API_BASE_URL=https://api.example.com
VITE_ENABLE_MOCK=false
```

**Dockeréƒ¨ç½²**:
```dockerfile
# Dockerfile
FROM node:20-alpine AS builder

WORKDIR /app
COPY package.json pnpm-lock.yaml ./
RUN npm install -g pnpm && pnpm install

COPY . .
RUN pnpm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

```bash
# æ„å»ºé•œåƒ
docker build -t nextest-pro:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  -p 80:80 \
  -e GEMINI_API_KEY=your-key \
  --name nextest-pro \
  nextest-pro:latest
```

**ç›‘æ§ä¸æ—¥å¿—**:
```mermaid
graph LR
    A[åº”ç”¨] --> B[æµè§ˆå™¨Console]
    A --> C[Vite Dev Server]
    A --> D[ç”Ÿäº§æ—¥å¿—]
    
    B --> B1[å‰ç«¯é”™è¯¯]
    C --> C1[HMRæ—¥å¿—]
    D --> D1[Nginx Access Log]
    D --> D2[Nginx Error Log]
```

**æ€§èƒ½ä¼˜åŒ–**:
1. **ä»£ç åˆ†å‰²**: ä½¿ç”¨åŠ¨æ€importåˆ†å‰²å¤§å‹ç»„ä»¶
2. **æ‡’åŠ è½½**: è·¯ç”±çº§åˆ«çš„æ‡’åŠ è½½
3. **CDNåŠ é€Ÿ**: é™æ€èµ„æºä½¿ç”¨CDN
4. **ç¼“å­˜ç­–ç•¥**: åˆç†è®¾ç½®æµè§ˆå™¨ç¼“å­˜
5. **å‹ç¼©**: å¯ç”¨Gzip/Brotliå‹ç¼©

**æ•…éšœæ’æŸ¥**:
```mermaid
flowchart TD
    A[é—®é¢˜] --> B{ç±»å‹}
    
    B -->|é¡µé¢ç©ºç™½| C[æ£€æŸ¥Consoleé”™è¯¯]
    B -->|APIå¤±è´¥| D[æ£€æŸ¥Network]
    B -->|æ€§èƒ½æ…¢| E[æ£€æŸ¥Performance]
    
    C --> C1[æ£€æŸ¥index.tsxåŠ è½½]
    C --> C2[æ£€æŸ¥è·¯ç”±é…ç½®]
    
    D --> D1[æ£€æŸ¥API_KEYé…ç½®]
    D --> D2[æ£€æŸ¥CORSè®¾ç½®]
    
    E --> E1[åˆ†æBundleå¤§å°]
    E --> E2[æ£€æŸ¥ç½‘ç»œè¯·æ±‚]
```

---

## é™„å½•

### A. å¿«é€Ÿå‚è€ƒ

**å¸¸ç”¨å‘½ä»¤**:
```bash
pnpm install          # å®‰è£…ä¾èµ–
pnpm run dev          # å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm run build        # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run preview      # é¢„è§ˆç”Ÿäº§æ„å»º
```

**ç›®å½•ç»“æ„**:
```
NextTestPlatformUI/
â”œâ”€â”€ components/          # Reactç»„ä»¶
â”‚   â”œâ”€â”€ admin/          # ç®¡ç†åå°ç»„ä»¶
â”‚   â”œâ”€â”€ auth/           # è®¤è¯ç»„ä»¶
â”‚   â”œâ”€â”€ dashboard/      # ä»ªè¡¨ç›˜ç»„ä»¶
â”‚   â””â”€â”€ ...
â”œâ”€â”€ hooks/              # è‡ªå®šä¹‰Hooks
â”œâ”€â”€ services/           # æœåŠ¡å±‚
â”œâ”€â”€ data/               # Mockæ•°æ®
â”œâ”€â”€ docs/               # æ–‡æ¡£
â”œâ”€â”€ types.ts            # TypeScriptç±»å‹å®šä¹‰
â”œâ”€â”€ App.tsx             # ä¸»åº”ç”¨ç»„ä»¶
â”œâ”€â”€ index.tsx           # å…¥å£æ–‡ä»¶
â””â”€â”€ vite.config.ts      # Viteé…ç½®
```

### B. æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| TestCase | æµ‹è¯•ç”¨ä¾‹ï¼ŒåŒ…å«å¤šä¸ªæµ‹è¯•æ­¥éª¤ |
| TestStep | æµ‹è¯•æ­¥éª¤ï¼Œå¯ç»‘å®šè„šæœ¬å’Œæ¡ä»¶ |
| Workflow | å·¥ä½œæµï¼Œå¯è§†åŒ–ç¼–æ’çš„è‡ªåŠ¨åŒ–æµç¨‹ |
| Script | è„šæœ¬ï¼ŒPython/JS/Shellä»£ç  |
| Environment | ç¯å¢ƒï¼ŒåŒ…å«ç¯å¢ƒå˜é‡é…ç½® |
| RBAC | åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ |
| Multi-tenancy | å¤šç§Ÿæˆ·ï¼Œæ•°æ®éš”ç¦»æ¶æ„ |

### C. æ›´æ–°æ—¥å¿—

**v0.0.0 (2025-11-22)**
- âœ¨ åˆå§‹ç‰ˆæœ¬
- âœ… æµ‹è¯•ç”¨ä¾‹ç®¡ç†
- âœ… å·¥ä½œæµç¼–æ’
- âœ… è„šæœ¬åº“ç®¡ç†
- âœ… RBACæƒé™ç³»ç»Ÿ
- âœ… å¤šç§Ÿæˆ·æ”¯æŒ
- âœ… AIé›†æˆï¼ˆGeminiï¼‰

---

**æ–‡æ¡£ç»“æŸ**

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

