# 历史归档

**最后更新**: 2025-11-26

---

## 归档说明

本层保留已废弃的文档，供历史参考和审计使用。

```
7-archive/
├── 2024-Q3/
│   └── old-architecture.md
│
└── 2024-Q4/
    ├── testcase-workflow-integration.md  # 被新文档取代
    ├── ci-platform-alignment.md
    └── deprecated-designs/
```

---

## 归档规则

### 何时归档

**文档归档触发条件**:
1. ✅ 文档被新版本完全取代
2. ✅ 设计方案被废弃或重新设计
3. ✅ 功能已下线或移除
4. ✅ 技术栈迁移导致文档过时
5. ✅ 季度末整理时发现的过时文档

**不应归档**:
- ❌ 仍在维护的文档（即使是旧版本）
- ❌ 需要更新而非归档的文档
- ❌ 临时草稿（应直接删除）

### 归档流程

```bash
# 1. 确定归档目标目录（按季度）
ARCHIVE_DIR="docs/7-archive/2024-Q4/"

# 2. 移动文档到归档目录
mv docs/6-decisions/old-decision.md $ARCHIVE_DIR/

# 3. 在文档顶部添加归档标记
# 见下方"归档标记模板"

# 4. 更新原文档位置的索引（如有）
# 移除或标注该文档已归档

# 5. 提交归档操作
git add docs/7-archive/ docs/6-decisions/index.md
git commit -m "docs: 归档过时决策文档到2024-Q4

- 移动old-decision.md到archive
- 更新决策索引"
```

### 归档标记模板

在归档文档的顶部添加:

```markdown
> **⚠️ 已归档文档**
>
> **归档日期**: 2025-11-26
> **归档原因**: 该设计方案已被新架构取代
> **替代文档**: [新文档链接](../../6-decisions/2025-11-26-new-architecture.md)
> **历史版本**: 原文档位于 `docs/6-decisions/old-decision.md`

---

[原文档内容保持不变]
```

---

## 按时间分类的归档目录

### 2024-Q4 (10月-12月)

| 文档名称 | 原位置 | 归档日期 | 归档原因 | 替代文档 |
|---------|--------|---------|---------|---------|
| testcase-workflow-integration.md | 6-decisions/ | 待补充 | 被统一工作流架构取代 | [2024-11-23-unified-workflow-architecture.md](../6-decisions/) |
| ci-platform-alignment.md | 6-decisions/ | 待补充 | CI集成方案变更 | - |

### 2024-Q3 (7月-9月)

| 文档名称 | 原位置 | 归档日期 | 归档原因 | 替代文档 |
|---------|--------|---------|---------|---------|
| old-architecture.md | - | 待补充 | 架构重构 | [architecture/overview.md](../5-wiki/architecture/overview.md) |

### 2024-Q2及更早

*暂无归档*

---

## 查找历史文档指南

### 按时间查找

1. **确定文档创建/修改时间**
2. **进入对应季度目录** (`YYYY-QX/`)
3. **浏览目录或使用搜索**

### 按关键词查找

```bash
# 在归档目录中搜索关键词
grep -r "workflow" docs/7-archive/

# 搜索特定类型文档
find docs/7-archive/ -name "*workflow*"
```

### 按原位置查找

如果知道文档原来在哪个层级:

```
原文档位置               → 归档目录
1-specs/            → 7-archive/YYYY-QX/specs/
2-requirements/     → 7-archive/YYYY-QX/requirements/
3-guides/           → 7-archive/YYYY-QX/guides/
4-planning/         → 7-archive/YYYY-QX/planning/ (或 4-planning/completed/)
5-wiki/             → 7-archive/YYYY-QX/wiki/
6-decisions/        → 7-archive/YYYY-QX/decisions/
```

---

## 归档目录组织

### 推荐结构

```
7-archive/
└── 2024-Q4/
    ├── specs/              # 来自1-specs/的归档
    ├── requirements/       # 来自2-requirements/的归档
    ├── guides/             # 来自3-guides/的归档
    ├── wiki/               # 来自5-wiki/的归档
    ├── decisions/          # 来自6-decisions/的归档
    ├── deprecated-features/  # 废弃功能的完整文档
    └── migration-notes/    # 迁移说明
```

**注意**: `4-planning/` 的归档通常放在 `4-planning/completed/` 而非7-archive/

---

## 归档文档的使用场景

### 1. 历史决策审计
**场景**: 理解某个功能"为什么当初这么设计"

**操作**:
1. 查找对应时期的归档决策文档
2. 阅读当时的备选方案和选择理由
3. 对比现在的实现

### 2. 回滚或恢复参考
**场景**: 新方案有问题，需要参考旧方案

**操作**:
1. 在归档中找到旧设计文档
2. 评估是否可以部分恢复
3. 创建新的ADR记录回滚决策

### 3. 知识学习
**场景**: 新成员了解系统演进历史

**操作**:
1. 按时间顺序阅读归档文档
2. 理解系统如何一步步发展
3. 避免重复已废弃的设计

### 4. 功能复活
**场景**: 之前废弃的功能需要重新实现

**操作**:
1. 查找归档的需求和设计文档
2. 评估当时废弃的原因是否仍然存在
3. 决定是复用旧设计还是重新设计

---

## 归档文档维护

### 定期清理

**每年执行一次** (建议每年1月):
1. 审查3年前的归档文档
2. 评估是否还需要保留
3. 极少访问的文档可以压缩存档或删除

### 归档索引

**每季度更新一次** (本README.md):
1. 添加新归档的文档到"按时间分类"表格
2. 更新统计信息
3. 检查归档标记是否正确

---

## 归档与删除的区别

| 操作 | 适用场景 | 保留内容 | 可恢复性 |
|------|---------|---------|---------|
| **归档** | 文档过时但有参考价值 | 完整保留 | 随时查阅 |
| **删除** | 临时草稿、重复文档、无价值内容 | 仅Git历史 | 需要从Git恢复 |

**原则**: 拿不准时选择归档，因为存储空间不是问题，知识丢失才是问题。

---

## 与其他文档层的关系

- **来源**: 所有其他层级 (1-6) 的过时文档
- **参考**: [6-decisions/](../6-decisions/) - 理解为什么某些方案被废弃
- **对比**: [5-wiki/](../5-wiki/) - 对比现在的业务逻辑
- **学习**: 了解系统演进历史

---

## 统计信息

- **归档季度**: 2个 (2024-Q3, 2024-Q4)
- **归档文档**: 约3篇
- **最早归档**: 2024-Q3
- **最近归档**: 2024-Q4

---

## 常见问题

### Q: 归档的文档还会更新吗？
**A**: 不会。归档文档是"历史快照"，不再维护更新。

### Q: 如果需要找某个功能的历史实现？
**A:**
1. 先在归档中查找对应的设计文档
2. 再用Git查看对应时期的代码
3. 结合归档文档和Git历史理解当时的实现

### Q: 归档和Git历史有什么区别？
**A:**
- **归档**: 保留完整文档，易于阅读和查找
- **Git历史**: 保留所有变更历史，但需要checkout才能查看

归档是对Git历史的补充，方便快速访问重要的历史文档。

### Q: 多久清理一次归档？
**A**: 建议每年审查一次，删除3年以上且极少访问的文档。但重要的架构决策文档应永久保留。

---

## 相关文档

- **文档架构设计**: [../6-decisions/2025-11-26-documentation-organization-architecture.md](../6-decisions/2025-11-26-documentation-organization-architecture.md)
- **文档维护规则**: [../6-decisions/2025-11-26-documentation-organization-architecture.md#文档维护规则](../6-decisions/2025-11-26-documentation-organization-architecture.md#文档维护规则)

---

## 归档清单模板

```markdown
## YYYY-QX 归档清单

**归档日期**: YYYY-MM-DD
**归档人**: [姓名]
**归档原因**: [季度末整理 / 架构重构 / 功能下线]

| 文档 | 原位置 | 归档原因 | 替代文档 |
|------|--------|---------|---------|
| doc1.md | 6-decisions/ | 方案废弃 | [新方案](链接) |
| doc2.md | 5-wiki/ | 功能下线 | - |

**备注**: [特殊说明]
```

---

**维护者**: 测试平台团队

**归档策略审查**: 每年1月
