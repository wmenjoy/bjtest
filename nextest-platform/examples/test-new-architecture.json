{
  "description": "测试统一 Workflow 架构 - 后端 API 测试",
  "testGroups": [
    {
      "groupId": "group-backend-api",
      "parentId": null,
      "name": "Backend API Tests",
      "description": "测试 nextest-platform 后端 API",
      "folderType": "service"
    }
  ],
  "testCases": [
    {
      "testId": "test-backend-health",
      "groupId": "group-backend-api",
      "name": "Health Check",
      "type": "workflow",
      "priority": "P0",
      "status": "active",
      "objective": "验证后端服务健康状态",
      "workflowDef": {
        "name": "Backend Health Check Workflow",
        "description": "检查后端服务是否正常运行",
        "steps": [
          {
            "id": "step-health",
            "name": "Health Check Request",
            "type": "http",
            "config": {
              "method": "GET",
              "url": "http://localhost:8090/health",
              "headers": {},
              "timeout": 5
            },
            "outputs": {
              "response.status": "healthStatus",
              "response.body.status": "serviceStatus"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{healthStatus}}",
                "expected": 200,
                "message": "Health endpoint should return 200"
              },
              {
                "type": "equals",
                "actual": "{{serviceStatus}}",
                "expected": "healthy",
                "message": "Service status should be healthy"
              }
            ]
          }
        ]
      }
    },
    {
      "testId": "test-backend-groups-api",
      "groupId": "group-backend-api",
      "name": "Test Groups API",
      "type": "workflow",
      "priority": "P0",
      "status": "active",
      "objective": "测试测试分组 API 的 CRUD 操作",
      "workflowDef": {
        "name": "Test Groups CRUD Workflow",
        "description": "验证测试分组的创建、查询、更新、删除操作",
        "steps": [
          {
            "id": "step-create-group",
            "name": "Create Test Group",
            "type": "http",
            "config": {
              "method": "POST",
              "url": "http://localhost:8090/api/v2/groups",
              "headers": {
                "Content-Type": "application/json"
              },
              "body": {
                "groupId": "test-group-auto-{{timestamp}}",
                "name": "Auto Test Group",
                "description": "Automatically created test group",
                "folderType": "folder"
              }
            },
            "outputs": {
              "response.body.groupId": "createdGroupId",
              "response.status": "createStatus"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{createStatus}}",
                "expected": 201,
                "message": "Create group should return 201"
              }
            ]
          },
          {
            "id": "step-get-groups",
            "name": "Get All Groups",
            "type": "http",
            "dependsOn": ["step-create-group"],
            "config": {
              "method": "GET",
              "url": "http://localhost:8090/api/v2/groups/tree",
              "headers": {}
            },
            "outputs": {
              "response.status": "getStatus",
              "response.body": "groupsData"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{getStatus}}",
                "expected": 200,
                "message": "Get groups should return 200"
              }
            ]
          },
          {
            "id": "step-delete-group",
            "name": "Delete Test Group",
            "type": "http",
            "dependsOn": ["step-get-groups"],
            "config": {
              "method": "DELETE",
              "url": "http://localhost:8090/api/v2/groups/{{createdGroupId}}",
              "headers": {}
            },
            "outputs": {
              "response.status": "deleteStatus"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{deleteStatus}}",
                "expected": 200,
                "message": "Delete group should return 200"
              }
            ]
          }
        ]
      }
    },
    {
      "testId": "test-backend-testcases-api",
      "groupId": "group-backend-api",
      "name": "Test Cases API",
      "type": "workflow",
      "priority": "P0",
      "status": "active",
      "objective": "测试测试案例 API 的完整生命周期",
      "workflowDef": {
        "name": "Test Cases Lifecycle Workflow",
        "description": "验证测试案例的创建、查询、执行、删除",
        "steps": [
          {
            "id": "step-create-testcase",
            "name": "Create Test Case",
            "type": "http",
            "config": {
              "method": "POST",
              "url": "http://localhost:8090/api/v2/tests",
              "headers": {
                "Content-Type": "application/json"
              },
              "body": {
                "testId": "test-auto-{{timestamp}}",
                "groupId": "group-backend-api",
                "name": "Auto Created Test",
                "type": "http",
                "priority": "P2",
                "status": "active",
                "objective": "Test automatically created",
                "http": {
                  "method": "GET",
                  "path": "/health",
                  "headers": {}
                }
              }
            },
            "outputs": {
              "response.body.testId": "createdTestId",
              "response.status": "createTestStatus"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{createTestStatus}}",
                "expected": 201,
                "message": "Create test should return 201"
              }
            ]
          },
          {
            "id": "step-get-testcase",
            "name": "Get Test Case Details",
            "type": "http",
            "dependsOn": ["step-create-testcase"],
            "config": {
              "method": "GET",
              "url": "http://localhost:8090/api/v2/tests/{{createdTestId}}",
              "headers": {}
            },
            "outputs": {
              "response.status": "getTestStatus",
              "response.body.name": "testName"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{getTestStatus}}",
                "expected": 200,
                "message": "Get test should return 200"
              },
              {
                "type": "equals",
                "actual": "{{testName}}",
                "expected": "Auto Created Test",
                "message": "Test name should match"
              }
            ]
          },
          {
            "id": "step-execute-testcase",
            "name": "Execute Test Case",
            "type": "http",
            "dependsOn": ["step-get-testcase"],
            "config": {
              "method": "POST",
              "url": "http://localhost:8090/api/v2/tests/{{createdTestId}}/execute",
              "headers": {
                "Content-Type": "application/json"
              },
              "body": {}
            },
            "outputs": {
              "response.status": "executeStatus",
              "response.body.result": "executionResult"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{executeStatus}}",
                "expected": 200,
                "message": "Execute test should return 200"
              }
            ]
          },
          {
            "id": "step-delete-testcase",
            "name": "Delete Test Case",
            "type": "http",
            "dependsOn": ["step-execute-testcase"],
            "config": {
              "method": "DELETE",
              "url": "http://localhost:8090/api/v2/tests/{{createdTestId}}",
              "headers": {}
            },
            "outputs": {
              "response.status": "deleteTestStatus"
            },
            "assertions": [
              {
                "type": "equals",
                "actual": "{{deleteTestStatus}}",
                "expected": 200,
                "message": "Delete test should return 200"
              }
            ]
          }
        ]
      }
    }
  ]
}
