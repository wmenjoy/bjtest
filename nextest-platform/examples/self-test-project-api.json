{
  "workflowId": "self-test-project-api",
  "name": "Project API Tests",
  "version": "1.0.0",
  "description": "Tests for Project API CRUD operations",
  "definition": {
    "variables": {
      "baseUrl": "http://localhost:8090/api/v2",
      "testTenantId": "test-tenant-for-project",
      "testProjectId": "test-project-selftest"
    },
    "steps": {
      "step01_cleanupProject": {
        "id": "step01_cleanupProject",
        "name": "Cleanup existing test project",
        "type": "http",
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/projects/{{testProjectId}}"
        },
        "onError": "continue"
      },
      "step02_cleanupTenant": {
        "id": "step02_cleanupTenant",
        "name": "Cleanup existing test tenant",
        "type": "http",
        "dependsOn": ["step01_cleanupProject"],
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}"
        },
        "onError": "continue"
      },
      "step03_createTenant": {
        "id": "step03_createTenant",
        "name": "Create Parent Tenant",
        "type": "http",
        "dependsOn": ["step02_cleanupTenant"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/tenants",
          "headers": {"Content-Type": "application/json"},
          "body": {
            "tenantId": "{{testTenantId}}",
            "name": "Tenant for Project Tests",
            "displayName": "Project Test Tenant",
            "maxProjects": 10
          }
        }
      },
      "step04_assertTenantCreated": {
        "id": "step04_assertTenantCreated",
        "name": "Assert Tenant Created",
        "type": "assert",
        "dependsOn": ["step03_createTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step03_createTenant.response.statusCode}}",
              "expected": 201,
              "message": "Create tenant should return 201"
            }
          ]
        }
      },
      "step05_createProject": {
        "id": "step05_createProject",
        "name": "Create Project",
        "type": "http",
        "dependsOn": ["step04_assertTenantCreated"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/projects",
          "headers": {"Content-Type": "application/json"},
          "body": {
            "projectId": "{{testProjectId}}",
            "tenantId": "{{testTenantId}}",
            "name": "Self Test Project",
            "displayName": "Self Test Project",
            "description": "Project for API self-testing"
          }
        }
      },
      "step06_assertCreate201": {
        "id": "step06_assertCreate201",
        "name": "Assert Create returns 201",
        "type": "assert",
        "dependsOn": ["step05_createProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step05_createProject.response.statusCode}}",
              "expected": 201,
              "message": "Create project should return 201"
            }
          ]
        }
      },
      "step07_getProject": {
        "id": "step07_getProject",
        "name": "Get Project",
        "type": "http",
        "dependsOn": ["step06_assertCreate201"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/projects/{{testProjectId}}"
        }
      },
      "step08_assertGet200": {
        "id": "step08_assertGet200",
        "name": "Assert Get returns 200",
        "type": "assert",
        "dependsOn": ["step07_getProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step07_getProject.response.statusCode}}",
              "expected": 200,
              "message": "Get project should return 200"
            }
          ]
        }
      },
      "step09_listProjects": {
        "id": "step09_listProjects",
        "name": "List All Projects",
        "type": "http",
        "dependsOn": ["step08_assertGet200"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/projects"
        }
      },
      "step10_assertList200": {
        "id": "step10_assertList200",
        "name": "Assert List returns 200",
        "type": "assert",
        "dependsOn": ["step09_listProjects"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step09_listProjects.response.statusCode}}",
              "expected": 200,
              "message": "List projects should return 200"
            }
          ]
        }
      },
      "step11_listTenantProjects": {
        "id": "step11_listTenantProjects",
        "name": "List Tenant Projects",
        "type": "http",
        "dependsOn": ["step10_assertList200"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}/projects"
        }
      },
      "step12_assertTenantProjects200": {
        "id": "step12_assertTenantProjects200",
        "name": "Assert Tenant Projects returns 200",
        "type": "assert",
        "dependsOn": ["step11_listTenantProjects"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step11_listTenantProjects.response.statusCode}}",
              "expected": 200,
              "message": "List tenant projects should return 200"
            }
          ]
        }
      },
      "step13_updateProject": {
        "id": "step13_updateProject",
        "name": "Update Project",
        "type": "http",
        "dependsOn": ["step12_assertTenantProjects200"],
        "config": {
          "method": "PUT",
          "url": "{{baseUrl}}/projects/{{testProjectId}}",
          "headers": {"Content-Type": "application/json"},
          "body": {
            "displayName": "Updated Self Test Project",
            "description": "Updated description"
          }
        }
      },
      "step14_assertUpdate200": {
        "id": "step14_assertUpdate200",
        "name": "Assert Update returns 200",
        "type": "assert",
        "dependsOn": ["step13_updateProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step13_updateProject.response.statusCode}}",
              "expected": 200,
              "message": "Update project should return 200"
            }
          ]
        }
      },
      "step15_archiveProject": {
        "id": "step15_archiveProject",
        "name": "Archive Project",
        "type": "http",
        "dependsOn": ["step14_assertUpdate200"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/projects/{{testProjectId}}/archive"
        }
      },
      "step16_assertArchive200": {
        "id": "step16_assertArchive200",
        "name": "Assert Archive returns 200",
        "type": "assert",
        "dependsOn": ["step15_archiveProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step15_archiveProject.response.statusCode}}",
              "expected": 200,
              "message": "Archive project should return 200"
            }
          ]
        }
      },
      "step17_activateProject": {
        "id": "step17_activateProject",
        "name": "Activate Project",
        "type": "http",
        "dependsOn": ["step16_assertArchive200"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/projects/{{testProjectId}}/activate"
        }
      },
      "step18_assertActivate200": {
        "id": "step18_assertActivate200",
        "name": "Assert Activate returns 200",
        "type": "assert",
        "dependsOn": ["step17_activateProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step17_activateProject.response.statusCode}}",
              "expected": 200,
              "message": "Activate project should return 200"
            }
          ]
        }
      },
      "step19_get404NonExistent": {
        "id": "step19_get404NonExistent",
        "name": "Get Non-existent Project",
        "type": "http",
        "dependsOn": ["step18_assertActivate200"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/projects/non-existent-project-xyz"
        }
      },
      "step20_assert404": {
        "id": "step20_assert404",
        "name": "Assert 404 for Non-existent",
        "type": "assert",
        "dependsOn": ["step19_get404NonExistent"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step19_get404NonExistent.response.statusCode}}",
              "expected": 404,
              "message": "Get non-existent project should return 404"
            }
          ]
        }
      },
      "step21_deleteProject": {
        "id": "step21_deleteProject",
        "name": "Delete Project",
        "type": "http",
        "dependsOn": ["step20_assert404"],
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/projects/{{testProjectId}}"
        }
      },
      "step22_assertProjectDelete200": {
        "id": "step22_assertProjectDelete200",
        "name": "Assert Project Delete returns 200",
        "type": "assert",
        "dependsOn": ["step21_deleteProject"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step21_deleteProject.response.statusCode}}",
              "expected": 200,
              "message": "Delete project should return 200"
            }
          ]
        }
      },
      "step23_deleteTenant": {
        "id": "step23_deleteTenant",
        "name": "Delete Tenant",
        "type": "http",
        "dependsOn": ["step22_assertProjectDelete200"],
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}"
        }
      },
      "step24_assertTenantDelete200": {
        "id": "step24_assertTenantDelete200",
        "name": "Assert Tenant Delete returns 200",
        "type": "assert",
        "dependsOn": ["step23_deleteTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step23_deleteTenant.response.statusCode}}",
              "expected": 200,
              "message": "Delete tenant should return 200"
            }
          ]
        }
      }
    }
  }
}
