{
  "workflowId": "self-test-tenant-api",
  "name": "Tenant API Tests",
  "version": "1.0.0",
  "description": "Tests for Tenant API CRUD operations",
  "definition": {
    "variables": {
      "baseUrl": "http://localhost:8090/api/v2",
      "testTenantId": "test-tenant-selftest"
    },
    "steps": {
      "step01_cleanup": {
        "id": "step01_cleanup",
        "name": "Cleanup existing test tenant",
        "type": "http",
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}"
        },
        "onError": "continue"
      },
      "step02_createTenant": {
        "id": "step02_createTenant",
        "name": "Create Tenant",
        "type": "http",
        "dependsOn": ["step01_cleanup"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/tenants",
          "headers": {"Content-Type": "application/json"},
          "body": {
            "tenantId": "{{testTenantId}}",
            "name": "Self Test Tenant",
            "displayName": "Self Test Tenant",
            "description": "Tenant for API self-testing",
            "maxProjects": 5,
            "maxUsers": 10,
            "maxTestCases": 100
          }
        }
      },
      "step03_assertCreate201": {
        "id": "step03_assertCreate201",
        "name": "Assert Create returns 201",
        "type": "assert",
        "dependsOn": ["step02_createTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step02_createTenant.response.statusCode}}",
              "expected": 201,
              "message": "Create tenant should return 201"
            }
          ]
        }
      },
      "step04_getTenant": {
        "id": "step04_getTenant",
        "name": "Get Tenant",
        "type": "http",
        "dependsOn": ["step03_assertCreate201"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}"
        }
      },
      "step05_assertGet200": {
        "id": "step05_assertGet200",
        "name": "Assert Get returns 200",
        "type": "assert",
        "dependsOn": ["step04_getTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step04_getTenant.response.statusCode}}",
              "expected": 200,
              "message": "Get tenant should return 200"
            }
          ]
        }
      },
      "step06_listTenants": {
        "id": "step06_listTenants",
        "name": "List Tenants",
        "type": "http",
        "dependsOn": ["step05_assertGet200"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/tenants"
        }
      },
      "step07_assertList200": {
        "id": "step07_assertList200",
        "name": "Assert List returns 200",
        "type": "assert",
        "dependsOn": ["step06_listTenants"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step06_listTenants.response.statusCode}}",
              "expected": 200,
              "message": "List tenants should return 200"
            }
          ]
        }
      },
      "step08_updateTenant": {
        "id": "step08_updateTenant",
        "name": "Update Tenant",
        "type": "http",
        "dependsOn": ["step07_assertList200"],
        "config": {
          "method": "PUT",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}",
          "headers": {"Content-Type": "application/json"},
          "body": {
            "displayName": "Updated Self Test Tenant",
            "description": "Updated description"
          }
        }
      },
      "step09_assertUpdate200": {
        "id": "step09_assertUpdate200",
        "name": "Assert Update returns 200",
        "type": "assert",
        "dependsOn": ["step08_updateTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step08_updateTenant.response.statusCode}}",
              "expected": 200,
              "message": "Update tenant should return 200"
            }
          ]
        }
      },
      "step10_suspendTenant": {
        "id": "step10_suspendTenant",
        "name": "Suspend Tenant",
        "type": "http",
        "dependsOn": ["step09_assertUpdate200"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}/suspend"
        }
      },
      "step11_assertSuspend200": {
        "id": "step11_assertSuspend200",
        "name": "Assert Suspend returns 200",
        "type": "assert",
        "dependsOn": ["step10_suspendTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step10_suspendTenant.response.statusCode}}",
              "expected": 200,
              "message": "Suspend tenant should return 200"
            }
          ]
        }
      },
      "step12_activateTenant": {
        "id": "step12_activateTenant",
        "name": "Activate Tenant",
        "type": "http",
        "dependsOn": ["step11_assertSuspend200"],
        "config": {
          "method": "POST",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}/activate"
        }
      },
      "step13_assertActivate200": {
        "id": "step13_assertActivate200",
        "name": "Assert Activate returns 200",
        "type": "assert",
        "dependsOn": ["step12_activateTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step12_activateTenant.response.statusCode}}",
              "expected": 200,
              "message": "Activate tenant should return 200"
            }
          ]
        }
      },
      "step14_get404NonExistent": {
        "id": "step14_get404NonExistent",
        "name": "Get Non-existent Tenant",
        "type": "http",
        "dependsOn": ["step13_assertActivate200"],
        "config": {
          "method": "GET",
          "url": "{{baseUrl}}/tenants/non-existent-tenant-xyz"
        }
      },
      "step15_assert404": {
        "id": "step15_assert404",
        "name": "Assert 404 for Non-existent",
        "type": "assert",
        "dependsOn": ["step14_get404NonExistent"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step14_get404NonExistent.response.statusCode}}",
              "expected": 404,
              "message": "Get non-existent tenant should return 404"
            }
          ]
        }
      },
      "step16_deleteTenant": {
        "id": "step16_deleteTenant",
        "name": "Delete Tenant",
        "type": "http",
        "dependsOn": ["step15_assert404"],
        "config": {
          "method": "DELETE",
          "url": "{{baseUrl}}/tenants/{{testTenantId}}"
        }
      },
      "step17_assertDelete200": {
        "id": "step17_assertDelete200",
        "name": "Assert Delete returns 200",
        "type": "assert",
        "dependsOn": ["step16_deleteTenant"],
        "config": {
          "assertions": [
            {
              "type": "equals",
              "actual": "{{step16_deleteTenant.response.statusCode}}",
              "expected": 200,
              "message": "Delete tenant should return 200"
            }
          ]
        }
      }
    }
  }
}
